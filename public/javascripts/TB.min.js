/*!
 * OpenTok JavaScript Library v0.91.63
 * http://www.tokbox.com/
 *
 * Copyright (c) 2011 TokBox, Inc.
 *
 * Date: September 13 11:05:40 2012
 */

/*
 *	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
 * 	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
 * 	
 * 	Permission is hereby granted, free of charge, to any person obtaining a copy
 * 	of this software and associated documentation files (the "Software"), to deal
 * 	in the Software without restriction, including without limitation the rights
 * 	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * 	copies of the Software, and to permit persons to whom the Software is
 * 	furnished to do so, subject to the following conditions:
 * 	
 * 	The above copyright notice and this permission notice shall be included in
 * 	all copies or substantial portions of the Software
 */
var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var r={};if(g&&typeof g===aD){for(var p in g){r[p]=g[p]}}r.data=k;r.width=h;r.height=f;var o={};if(i&&typeof i===aD){for(var q in i){o[q]=i[q]}}if(b&&typeof b===aD){for(var l in b){if(typeof o.flashvars!=aq){o.flashvars+="&"+l+"="+b[l]}else{o.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(r,o,e);if(r.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){r.data=a;ae(r,o,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();
/*
* JavaScript Debug - v0.4 - 6/22/2010
* http://benalman.com/projects/javascript-debug-console-log/
* 
* Copyright (c) 2010 "Cowboy" Ben Alman
* Dual licensed under the MIT and GPL licenses.
* http://benalman.com/about/license/
* 
* With lots of help from Paul Irish!
* http://paulirish.com/
*/
window.opentokdebug=(function(){var i=this,m=i.document,g=Array.prototype.slice,f=i.console,h={},r,c,q=0,t=["error","warn","info","debug","log"],b="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),j=b.length,o=false,d=m.createElement("div"),a=[];while(--j>=0){(function(u){h[u]=function(){f=i.console;if(q!==0&&f){if(f[u]&&typeof(f[u].apply)!="undefined"){f[u].apply(f,arguments)}else{var v=g.call(arguments);if(u.indexOf("group")!=-1){v.unshift("["+u+"]");h.log(v.join(" "))}}}}})(b[j])}j=t.length;while(--j>=0){(function(u,v){h[v]=function(){var x=g.call(arguments),w=[v,e()].concat(x);a.push(w);if(!k(u)){return}if(o){var y=m.createTextNode(w);d.appendChild(y);d.appendChild(m.createElement("br"))}s(w);f=i.console;if(!f&&!o){return}f[v]?p(v,x):p("log",x)}})(j,t[j])}function p(v,u){if(typeof(f[v].apply)!="undefined"){f[v].apply(f,u)}else{f[v](u.join(" "))}}function s(u){if(r&&(c||!f||!f.log)){r.apply(i,u)}}h.setLevel=function(u){q=typeof u==="number"?u:9};function k(u){return q>0?q>u:t.length+q<=u}h.setCallback=function(){var v=g.call(arguments),u=a.length,w=u;r=v.shift()||null;c=typeof v[0]==="boolean"?v.shift():false;w-=typeof v[0]==="number"?v.shift():u;while(w<u){s(a[w++])}};h.getLogs=function(){return a.join("\n")};h.setDomInsertion=function(v,u){o=v;if(v&&m.body){m.body.appendChild(d);var w="debug";if(typeof(u)=="string"){w=u}d.className=w}else{d.parentNode.removeChild(d)}};function l(v){try{return v instanceof HTMLElement}catch(u){return(typeof v==="object")&&(v.nodeType===1)&&(typeof v.style==="object")&&(typeof v.ownerDocument==="object")}}function e(){var u=new Date();return u.toLocaleTimeString()+u.getMilliseconds()}h.exportLogs=function(u){if(l(u)){u.innerHTML=a.join("<br />")}};return h})();if(!Object.keys){Object.keys=function(c){if(c!==Object(c)){throw new TypeError("Object.keys called on non-object")}var a=[],b;for(b in c){if(Object.prototype.hasOwnProperty.call(c,b)){a.push(b)}}return a}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c){if(this===void 0||this===null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var e=0;if(arguments.length>0){e=Number(arguments[1]);if(e!==e){e=0}else{if(e!==0&&e!==Infinity&&e!==-Infinity){e=(e>0||-1)*Math.floor(Math.abs(e))}}}if(e>=a){return -1}var b=e>=0?e:Math.max(a-Math.abs(e),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}}(function(c){var d=/chrome\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(navigator.userAgent.toLowerCase());var b=function(){var e=c.navigator.userAgent.toLowerCase(),f;if(e.indexOf("firefox")>-1){return"Firefox"}if(e.indexOf("opera")>-1){return"Opera"}else{if(e.indexOf("msie")>-1){return"IE"}else{if(e.indexOf("chrome")>-1){return"Chrome"}}}if((f=c.navigator.vendor)&&f.toLowerCase().indexOf("apple")>-1){return"Safari"}return"unknown"};c.TB_ChromeAllowFix={allowDenyBugPresent:b()==="Chrome"&&parseInt(d[1],10)>=21};var a=function(f,e){return Math.round(f*Math.pow(10,e))/Math.pow(10,e)};c.TB_ChromeAllowFix.AllowFixer=function(i){var l={},o={},f={},h;var j=function(){if(!i||!i.parentNode){this.stop();return}m("parent",i.offsetParent);m("element",i);h=setTimeout(j,500)};var m=function(r,q){if(!q){return}if(!f[r]){f[r]={}}if(!o[r]){o[r]={marginLeft:q.style.marginLeft}}else{if(q.style.marginLeft&&parseFloat(q.style.marginLeft)!==f[r].marginLeft){o[r].marginLeft=q.style.marginLeft}}var p=q.getBoundingClientRect();if(!l[r]||l[r].left!=p.left||l[r].top!=p.top){e(q);f[r].marginLeft=q.style.marginLeft&&q.style.marginLeft.length?parseFloat(q.style.marginLeft):null;l[r]=q.getBoundingClientRect()}};var e=function(s){var w=s.getBoundingClientRect(),q=w.left,v=a(Math.round(q)-q,3);if(v!=0){var u=g(s,"marginLeft");s.style.marginLeft=u+v+"px"}var p=w.top,r=a(Math.round(p)-p,3);if(r!=0){var t=g(s,"top");s.style.top=t+r+"px";if(k(s,"position")==="static"){s.style.position="relative"}}};var g=function(q,r){var p=k(q,r);n=parseFloat(p,10);return n?n:0};var k=function(q,r){var p=q.ownerDocument.defaultView.getComputedStyle(q,null)[r];return p===""?q.style[r]:p};this.start=function(){if(!h){j()}};this.stop=function(){if(h){clearTimeout(h);h=null}if(i){i.style.marginLeft=o.element.marginLeft;var p=i.offsetParent;if(p){p.style.marginLeft=o.parent.marginLeft}}}}})(window);(function(aU){var A="10.0.0";var ax=215;var j=138;var v;var B;var a3;var aW=false;var L=false;var ag={};var O="true";var G="http://static.opentok.com";var aw=G+"/opentok/assets/flash/expressInstall.swf";if(O=="true"&&aU.location.protocol=="https:"){G="https://swww.tokbox.com"}var M;var H={};var ao={};var aK=false;var z=false;var aH=false;var aZ;var e={1000:"Failed To Load",1004:"Authentication error",1005:"Invalid Session ID",1006:"Connect Failed",1007:"Connect Rejected",1008:"Connect Time-out",1009:"Security Error",1010:"Not Connected",1011:"Invalid Parameter",1012:"Peer-to-peer Stream Play Failed",1013:"Peer-to-peer Connection Failed",1014:"API Response Failure",2000:"Internal Error",2001:"Embed Failed",1500:"Unable to Publish",1510:"Unable to Signal",1520:"Unable to Force Disconnect",1530:"Unable to Force Unpublish",1535:"Force Unpublish on Invalid Stream",1540:"Unable to record archive",1550:"Unable to play back archive",1560:"Unable to create archive",1570:"Unable to load archive",3000:"Archive load exception",3001:"Archive create exception",3002:"Playback stop exception",3003:"Playback start exception",3004:"Record start exception",3005:"Record stop exception",3006:"Archive load exception",3007:"Session recording in progress",3008:"Archive recording internal failure"};function a1(){return aU.location.hostname}var ab=1,ap={},c=(function(){var a5=(function(){var a6=document.getElementsByTagName("script");a6=a6[a6.length-1];a6=a6.getAttribute("src")||a6.src;return a6})();var a4=a5.match(/[\?\&]apikey=([^&]+)/i);return a4?a4[1]:""})();function aD(){this._listeners={};this.addEventListener=function(a4,a5){if(!a4){throw new Error("EventDispatcher.addEventListener :: No type specified")}if(!a5){throw new Error("EventDispatcher.addEventListener :: No listener function specified")}if(!this._listeners.hasOwnProperty(a4)){this._listeners[a4]=[]}this.removeEventListener(a4,a5);u("TB.addEventListener("+a4+")");this._listeners[a4].push(a5)};this.removeEventListener=function(a5,a6){if(!a5){throw new Error("EventDispatcher.removeEventListener :: No type specified")}if(!a6){throw new Error("EventDispatcher.removeEventListener :: No listener function specified")}u("TB.removeEventListener("+a5+")");if(this._listeners.hasOwnProperty(a5)){for(var a4=0;a4<this._listeners[a5].length;a4++){if(this._listeners[a5][a4]==a6){this._listeners[a5].splice(a4,1);break}}}};this.dispatchEvent=function(a7){if(!a7){throw new Error("EventDispatcher.dispatchEvent :: No event specified")}if(!a7.type){throw new Error("EventDispatcher.dispatchEvent :: Event has no type")}if(!a7.target){a7.target=this}if(this._listeners.hasOwnProperty(a7.type)){var a6=this._listeners[a7.type];if(a6 instanceof Array){for(var a4=0;a4<a6.length;a4++){var a5=av(a6[a4],a7);setTimeout(a5,1)}}else{throw new Error("EventDispatcher.dispatchEvent :: Invalid object type in listeners")}}}}function W(a6,a4){this.type=a6;this.cancelable=a4?a4:false;this.target=null;var a5=false;this.preventDefault=function(){if(this.cancelable){a5=true}else{a2("Event.preventDefault :: Trying to preventDefault on an Event that isn't cancelable")}};this.isDefaultPrevented=function(){return a5}}function aC(a4,a5){this.superClass=W;this.superClass(a4);this.value=a5}function K(a5,a7,a8,a6,a4){this.superClass=W;this.superClass(a5);this.message=a7;this.title=a8;this.code=a6;this.component=a4}function ai(a4,a5){this.superClass=W;this.superClass(a4);this.issueId=a5}function N(a4){this.superClass=W;this.superClass(a4)}function m(a4){this.superClass=W;this.superClass(a4)}function ac(a4){this.superClass=W;this.superClass(a4)}function aJ(a5,a4,a6){this.superClass=W;this.superClass(a5);this.connections=a4;this.reason=a6}function aL(a5,a7,a6,a4){this.superClass=W;this.superClass(a5,a4);this.streams=a7;this.reason=a6}function aY(a6,a5,a7,a4){this.superClass=W;this.superClass(a6);this.connections=a5;this.streams=a7;this.archives=a4;this.groups=[]}function y(a5,a6,a4){this.superClass=W;this.superClass(a5,a4);this.reason=a6}function aQ(a4,a5){this.superClass=W;this.superClass(a4);this.fromConnection=a5}function an(a4,a6,a5){this.superClass=W;this.superClass(a4);this.streamId=a6;this.volume=a5}function g(a5,a4,a6){this.superClass=W;this.superClass(a5);this.camera=a4;this.microphone=a6}function am(a7,a4,a6,a5,a8){this.superClass=W;this.superClass(a7);this.cameras=a4;this.microphones=a6;this.selectedCamera=a5;this.selectedMicrophone=a8}function o(a5,a6,a4,a8,a7){this.superClass=W;this.superClass(a5);this.widthFrom=a6;this.widthTo=a4;this.heightFrom=a8;this.heightTo=a7}function Y(a5,a7,a8,a4,a6){this.superClass=W;this.superClass(a5);this.type=a5;this.stream=a7;this.changedProperty=a8;this.oldValue=a4;this.newValue=a6}function aI(a5,a4){this.superClass=W;this.superClass(a5);this.archives=a4}function a(a5,a4,a6){this.superClass=W;this.superClass(a5);this.archive=a4;this.streams=a6}function al(a4,a5){this.superClass=W;this.superClass(a4);this.changedValues=a5}function ar(a4,a7,a5,a6){this.superClass=W;this.superClass(a4);this.reasonCode=a7;this.reason=a5;this.failedValues=a6}var aO=(function(){var bc=4000,bf=false,ba=null,a5=null,a7,a8=document.head||document.getElementsByTagName("head")[0],be,bd=function(){if(be){clearTimeout(be);be=null}},a4=function(){bd();if(a7){a7.onload=a7.onreadystatechange=null;if(a8&&a7.parentNode){a8.removeChild(a7)}a7=undefined}},a6=function(){if(a7.readyState&&!/loaded|complete/.test(a7.readyState)){return}bd()},bb=function(bg,bh){if(bh&&a5[bh]&&a5[bh][bg]){return a5[bh][bg]}return ba[bg]},a9={load:function(){bf=false;a7=document.createElement("script");a7.async="async";a7.src=G+"/v0.91.63/js/dynamic_config.min.js";a7.onload=a7.onreadystatechange=a6;a8.appendChild(a7);be=setTimeout(function(){a9._onLoadTimeout()},bc)},_onLoadTimeout:function(){a4();a2("TB DynamicConfig failed to load in "+bc+" ms");this.dispatchEvent(new ac("dynamicConfigLoadFailed"))},isLoaded:function(){return bf},replaceWith:function(bg){a4();if(!bg){bg={}}ba=bg.global||{};a5=bg.partners||{};if(!bf){bf=true}this.dispatchEvent(new m("dynamicConfigChanged"))},get:function(bg,bi,bj){var bh=bb(bg,bj);return bh?bh[bi]:null}};a9.superClass=aD;a9.superClass();return a9})();function R(a6,a4,a5){this.connectionId=a6;this.creationTime=Number(a4);this.data=a5;this.quality=null}function ae(a4,a7,a5,bb,be,bc,bd,a9,a6,ba,a8,bf){this.streamId=a4;this.sessionId=ba;this.connection=a7;this.name=a5;this.data=bb;this.type=be;this.creationTime=bc;this.hasAudio=bd;this.hasVideo=a9;this.orientation=a6;this.peerId=a8;this.quality=bf;this.startRecording=function(bh){u("Stream.startRecording()");var bk="controller_"+ba,bj;bh=H[ba][bh.archiveId];if(!bh){bj="Stream.startRecording :: Archive not created.";aG(bj);throw new Error(bj)}if(bh.type!=b.PER_STREAM){bj="Stream.startRecording :: Trying to record per stream on a "+bh.type+" archive";aG(bj);throw new Error(bj)}if(bk&&this.connection&&this.connection.connectionId){try{var bg=document.getElementById(bk);bg.startRecordingStream(this.streamId,bh.archiveId)}catch(bi){bj="Stream.startRecording :: "+bi;aG(bj);throw new Error(bj)}}else{bj="Stream.startRecording :: Connection required to record an archive.";aG(bj);throw new Error(bj)}};this.stopRecording=function(bh){u("Stream.stopRecording()");var bj;bh=H[ba][bh.archiveId];if(!bh){bj="Stream.stopRecording :: Archive not created.";aG(bj);throw new Error(bj)}if(bh.type!=b.PER_STREAM){bj="Stream.stopRecording :: Trying to stop recording per stream on a "+bh.type+" archive";aG(bj);throw new Error(bj)}var bk="controller_"+ba;if(bk&&this.connection&&this.connection.connectionId){try{var bg=document.getElementById(bk);bg.stopRecordingStream(this.streamId,bh.archiveId)}catch(bi){bj="Stream.stopRecording :: "+bi;aG(bj);throw new Error(bj)}}else{bj="Stream.stopRecording :: Connection required to record an archive.";aG(bj);throw new Error(bj)}}}function aA(a7,a5){this.id=a7;this.replacedDivId=a5;this.parentClass=aD;this.parentClass();var a4=this;this._={parent:this};var a6=[];this._.DOMcomponent=document.getElementById(this.id);this._.load=function(a9,ba){ap[a4.id]=a4;for(var a8 in a9){if(a9.hasOwnProperty(a8)){a4[a8]=a9[a8]}}aZ.onLoad(function(){var bb=a4.replacedDivId,bc=a4.id;if(!bb){document.body.appendChild((function(){var bd=document.createElement("div");bb="component_replace_"+bc;bd.setAttribute("id",bb);return bd})())}else{if(typeof(bb)!=="string"&&"id" in bb){if(!bb.id){bb.id="tmpId"+Math.random()}bb=bb.id}}a4.replacedDivId=bb;if(!document.getElementById(bb)){errorMsg="UIComponent :: replaceElementId does not exist in DOM.";aG(errorMsg);throw new Error(errorMsg)}X(a4.src,a4.replacedDivId,a4.properties.width,a4.properties.height,A,false,a4.properties,a4.params,a4.attributes)})};this._.onload=function(){u("Component loaded: "+this.id);this._.DOMcomponent=document.getElementById(this.id);for(var a8=0;a8<a6.length;a8++){a6[a8].call(this._)}if(this.modified){this.setStyle(this._style);this.modified=false}this.dispatchEvent(new W("loaded"))};this._.callFlash=function(bc,a9,a8){if(!a8||typeof(a8)!=="object"){a8={}}if(!a9){a9=[]}u("Pending: "+bc+"("+a9.join(",")+") on component "+this.parent.id);var ba=a8.debug||(bc+"("+a9.join(",")+") on component "+this.parent.id+" failed");var bb=function bb(){try{u("callFlash: "+bc+"("+a9.join(",")+") on component "+this.parent.id);return this.DOMcomponent[bc].apply(this.DOMcomponent,a9)}catch(bd){if(!a8||!a8.hasOwnProperty("silentError")||!a8.silentError){aG(ba);throw new Error(ba)}}return false};if(!a8.once){a6.push(bb)}if(this.DOMcomponent){return bb.call(this)}else{if(a8.otherwise){return(typeof(a8.otherwise)!=="function")?a8.otherwise:a8.otherwise()}}}}function aj(a7,a5){aA.apply(this,arguments);var a4=["showMicButton","showSpeakerButton","showSettingsButton","showCameraToggleButton","nameDisplayMode","buttonDisplayMode","showSaveButton","showRecordButton","showRecordStopButton","showReRecordButton","showPauseButton","showPlayButton","showPlayStopButton","showStopButton","backgroundImageURI","showControlPanel","showRecordCounter","showPlayCounter","showControlBar","showPreviewTime"];this.getStyle=function(ba){var a8=document.getElementById(this.id),bd;if(!this.loaded){if(ba){return this._style[ba]}else{return this._style}}else{if(a8){try{var bb=a8.getStyle(ba);if(typeof(bb)=="string"){return bb}for(var a9 in bb){if(bb[a9]=="false"){bb[a9]=false}if(bb[a9]=="true"){bb[a9]=true}if(a4.indexOf(a9)<0){delete bb[a9]}}return bb}catch(bc){bd="Publisher.getStyle:: Failed to call getStyle. "+bc;aG(bd);throw new Error(bd)}}else{bd="Publisher.getStyle:: Publisher "+this.id+" does not exist.";aG(bd);throw new Error(bd)}}};this._style={};var a6={buttonDisplayMode:["auto","off","on"],nameDisplayMode:["auto","off","on"],showSettingsButton:[true,false],showMicButton:[true,false],showCameraToggleButton:[true,false],showSaveButton:[true,false],backgroundImageURI:null,showControlBar:[true,false],showPlayCounter:[true,false],showRecordCounter:[true,false],showPreviewTime:[true,false]};this.setStyle=function(ba,bd){u("Publisher.setStyle: "+ba.toString());var a8=document.getElementById(this.id),bc;if(!this.loaded){if(arguments.length>1){if(this._style.hasOwnProperty(ba)&&(ba=="backgroundImageURI"||(a6[ba].indexOf(bd)>-1))){u("setStyle::Setting "+ba+" to "+bd);this._style[ba]=bd}else{a2("setStyle::Invalid style property passed "+ba+" : "+bd)}}else{for(var a9 in ba){this.setStyle(a9,ba[a9])}}this.modified=true}else{if(a8){try{a8.setStyle(ba,bd)}catch(bb){bc="Publisher.setStyle:: Failed to call setStyle. "+bb;aG(bc);throw new Error(bc)}}else{bc="Publisher.setStyle:: Publisher "+this.id+" does not exist.";aG(bc);throw new Error(bc)}}return this}}function w(a5,a4){aj.apply(this,arguments);this.getImgData=function(){return this._.callFlash("getImgData")}}function U(a8,a7,a6){a6=(a6)?aP(a6):{};if(a6.name!==undefined&&a6.name.length>1000){errorMsg="Session.publish :: name property longer than 1000 chars.";aG(errorMsg);throw new Error(errorMsg)}if(a6.data!==undefined&&a6.data.length>1000){errorMsg="Session.publish :: data property longer than 1000 chars.";aG(errorMsg);throw new Error(errorMsg)}a6.apiKey=a6.apiKey||c;if(!a6.apiKey){errorMsg="initPublisher :: apiKey missing.";aG(errorMsg);throw new Error(errorMsg)}w.apply(this,arguments);this._style={showMicButton:true,showSettingsButton:true,showCameraToggleButton:true,nameDisplayMode:"auto",buttonDisplayMode:"auto",backgroundImageURI:null};var a4=264;var a5=198;this.loaded=false;this.panelId=null;this.properties=k({microphoneGain:50,publishAudio:true,publishVideo:true},a6,{simulateMobile:b.simulateMobile,cameraSelected:aW,publisherId:this.id,startTime:(new Date()).getTime()});if(!this.properties.width||isNaN(this.properties.width)){this.properties.width=a4}if(!this.properties.height||isNaN(this.properties.height)){this.properties.height=a5}if(a6&&a6.hasOwnProperty("style")){this.setStyle(a6.style);this.properties.style=encodeURIComponent(V(this.properties.style));this.modified=true}if(this.properties.wmode){delete this.properties.wmode}if(this.properties.apikey){delete this.properties.apikey}this._.load({src:G+"/v0.91.63/flash/f_publishwidget.swf?partnerId="+a6.apiKey,attributes:{id:this.id,style:"outline:none;"},params:{allowscriptaccess:"always",cameraSelected:aW,wmode:a6.wmode||"transparent"}});this._.refresh=function(){this.parent.properties.startTime=(new Date()).getTime();this.callFlash("cleanupView",null,{once:true});this.parent.replacedDivId=this.parent.id;this.load()};this._.publishToSession=function(bb,ba,a9){this.callFlash("publishToSession",[bb,ba,a9]);return this.parent};this._.unpublishFromSession=function(a9){if(this.DOMcomponent){this.callFlash("unpublishFromSession",[a9])}return this.parent};this.setMicrophoneGain=function(a9){this.properties.microphoneGain=parseInt(a9,10);this._.callFlash("setMicGain",[a9],{debug:"Microphone gain adjustment on publisher "+this.id+" failed. "});return this};this.getMicrophoneGain=function(){return this._.callFlash("getMicGain",null,{debug:"Microphone gain request on publisher "+this.id+" failed. ",otherwise:this.properties.microphoneGain})};this.getEchoCancellationMode=function(){return this._.callFlash("getEchoCancellationMode",null,{debug:"Getting echo cancellation mode for publisher "+this.id+" failed. ",otherwise:"unknown"})};this.enableMicrophone=function(){this.publishAudio(true);return this};this.disableMicrophone=function(){this.publishAudio(false);return this};this.publishAudio=function(a9){u("Publisher.publishAudio()");this.properties.publishAudio=!!a9;this._.callFlash("setStreamProperty",["publishAudio",!!a9]);return this};this.publishVideo=function(a9){u("Publisher.publishVideo()");this.properties.publishVideo=!!a9;this._.callFlash("setStreamProperty",["publishVideo",!!a9]);return this};this.setCamera=function(a9){this.properties.cameraName=[typeof(a9)==="string"?a9:a9.name];this._.callFlash("setCamera",this.properties.cameraName);return this};this.setMicrophone=function(a9){this.properties.microphoneName=[typeof(a9)==="string"?a9:a9.name];this._.callFlash("setMicrophone",this.properties.microphoneName);return this};this.detectDevices=function(){this._.callFlash("detectDevices");return this};this.detectMicActivity=function(a9){this._.callFlash("detectMicActivity",[a9!==false]);return this};this.destroy=function(){if(this._.DOMcomponent&&this._.DOMcomponent.parentNode){this._.callFlash("cleanupView");this._.DOMcomponent.parentNode.removeChild(this._.DOMcomponent);this._.DOMcomponent=null}else{u("The item doesn't exist to be detroyed")}return this};this._.signalRecording=function(a9){return this.callFlash(a9?"signalRecordingStarted":"signalRecordingStopped")}}function ah(a8,a9,a7,a5){this.superClass=w;this.superClass(a9,a7);this._style={nameDisplayMode:"auto",buttonDisplayMode:"auto",backgroundImageURI:null};this.modified=false;if(a5&&a5.hasOwnProperty("style")){this.setStyle(a5.style);this.modified=true}this.stream=a8;this.properties=a5;this.loaded=false;this.audioVolume=50;var a4=true;var a6=true;if(a5){if(a5.hasOwnProperty("subscribeToAudio")&&(a5.subscribeToAudio==="false"||a5.subscribeToAudio==false)){a4=false}if(a5.hasOwnProperty("subscribeToVideo")&&(a5.subscribeToVideo==="false"||a5.subscribeToVideo==false)){a6=false}if(a5.hasOwnProperty("audioVolume")){this.audioVolume=parseInt(a5.audioVolume,10)}}this.enableAudio=function(){this.subscribeToAudio(true)};this.disableAudio=function(){this.subscribeToAudio(false)};this.setAudioVolume=function(bd){var ba=document.getElementById(this.id),bc;if(!this.loaded){this.audioVolume=bd}else{if(ba){try{ba.setAudioVolume(bd)}catch(bb){bc="Volume adjustment on subscriber "+this.id+" failed";aG(bc);throw new Error(bc)}}else{bc="Subscriber "+this.id+" does not exist.";aG(bc);throw new Error(bc)}}return this};this.getAudioVolume=function(){var ba=document.getElementById(this.id),bc;if(!this.loaded){return this.audioVolume}if(ba){try{return ba.getAudioVolume()}catch(bb){bc="Volume adjustment on subscriber "+this.id+" failed";aG(bc);throw new Error(bc)}}else{bc="Subscriber "+this.id+" does not exist.";aG(bc);throw new Error(bc)}return this};this._subscribeToAudio=function(ba,bb){u("Subscriber.subscribeToAudio()");if(!bb||a4){if(!this.loaded){this.audioSubscribed=ba;this.modified=true}else{l(this.id,"subscribeToAudio",ba)}}};this.subscribeToAudio=function(ba){a4=ba;this._subscribeToAudio(a4,false)};this._subscribeToVideo=function(ba,bb){u("Subscriber.subscribeToVideo()");if(!bb||a6){if(!this.loaded){this.videoSubscribed=ba;this.modified=true}else{l(this.id,"subscribeToVideo",ba)}}};this.subscribeToVideo=function(ba){a6=ba;this._subscribeToVideo(a6,false)};this.changeOrientation=function(ba){u("Subscriber.changeOrientation()");l(this.id,"changeOrientation",ba)}}function au(a7,a6,a4,a5){this.superClass=aA;this.superClass(a7,a6);if(a4){this.publisher=a4;this.component=a4}else{this.publisher=null;this.component=a4}this.parentCreated=false;this.properties=a5}function aX(a5,a4){this.name=a5;this.status=a4}function aT(a5,a4){this.name=a5;this.status=a4}function C(a6,a5,a9,a8,a4){this.archiveId=a6;this.type=a5;this.title=a9;this.sessionId=a8;var a7;if(a4=="sessionRecordingInProgress"){this.status="open"}else{this.status=a4}this.startPlayback=function(bb){if(!bb){bb=false}u("Archive.startPlayback() : "+bb);var bf="controller_"+a8,bc=b.sessions[a8].connection,be;if(!ao[a8][this.archiveId]){be="Archive.startPlayback :: Archive not loaded.";aG(be);throw new Error(be)}if(bf&&bc&&bc.connectionId){try{var ba=document.getElementById(bf);ba.startPlayback(this.archiveId,bb)}catch(bd){be="Archive.startPlayback :: "+bd;aG(be);throw new Error(be)}}else{be="Archive.startPlayback :: Connection required to play back an archive.";aG(be);throw new Error(be)}};this.stopPlayback=function(){u("Archive.stopPlayback()");var be="controller_"+a8,bb=b.sessions[a8].connection,bd;if(be&&bb&&bb.connectionId){try{var ba=document.getElementById(be);ba.stopPlayback(this.archiveId)}catch(bc){bd="Archive.stopPlayback :: "+bc;aG(bd);throw new Error(bd)}}else{bd="Archive.stopPlayback :: Connection required to stop playing back an archive.";aG(bd);throw new Error(bd)}};this.getStateManager=function(){u("Archive.getStateManager() "+a6);if(a7){return a7}else{var bc="controller_"+a8;var ba=b.sessions[a8].connection;if(bc&&ba&&ba.connectionId){a7=new T(bc,a6);return a7}}var bb="Archive.getStateManager :: Connection required to getStateManager. Make sure that this archive was loaded in a Session.";aG(bb);throw new Error(bb)}}function aq(a6,a5,a4){this.superClass=w;this.superClass(a6,a5);this._style={buttonDisplayMode:"auto",showCameraToggleButton:true,showControlBar:true,showMicButton:true,showPlayCounter:true,showRecordCounter:true,showSaveButton:true,showSettingsButton:true};this.id=a6;this.properties=a4;this.saveArchive=function(){var a7=document.getElementById(this.id);a7.save()};this.setCamera=function(a7){u("Recorder.setCamera("+a7+")");i(this.id,a7,true)};this.setMicrophone=function(a7){u("Recorder.setMicrophone("+a7+")");i(this.id,a7,false)};this.stopRecording=function(){recorderElement=document.getElementById(this.id);recorderElement.stopRecording()};this.startRecording=function(a7){recorderElement=document.getElementById(this.id);recorderElement.startRecording(a7)};this.startPlaying=function(){u("Recorder.startPlaying()");try{var a7=document.getElementById(this.id);a7.startPlaying()}catch(a9){var a8="Recorder.startPlaying :: "+a9;aG(a8);throw new Error(a8)}};this.stopPlaying=function(){u("Recorder.stopPlaying()");try{var a7=document.getElementById(this.id);a7.stopPlaying()}catch(a9){var a8="Recorder.stopPlaying :: "+a9;aG(a8);throw new Error(a8)}};this.setTitle=function(ba){var a7=document.getElementById(this.id),a9;if(!this.loaded){this._title=ba;this.modified=true}else{if(a7){try{a7.setTitle(ba)}catch(a8){a9="Setting archive title on Recorder "+this.id+" failed.";aG(a9);throw new Error(a9)}}else{a9="Recorder "+this.id+" does not exist.";aG(a9);throw new Error(a9)}}}}function aM(a6,a5,a4){this.superClass=w;this.superClass(a6,a5);this._style={showPlayButton:true,showStopButton:true,showSpeakerButton:true,showPreviewTime:true};this.id=a6;this.properties=a4;this.loadArchive=function(ba){var a9;if(ba){if(this.loaded){try{var a7=document.getElementById(this.id);a7.loadArchive(ba);this.archiveId=ba}catch(a8){a9="Player.loadArchive :: "+a8;aG(a9);throw new Error(a9)}}else{this._archiveId=ba}}else{a9="Player.loadArchive :: Archive id required to load an archive.";aG(a9);throw new Error(a9)}};this.play=function(){if(this.loaded){try{var a7=document.getElementById(this.id);a7.startPlayback()}catch(a9){var a8="Player.play :: "+a9;aG(a8);throw new Error(a8)}}else{this._play=true}};this.stop=function(){if(this.loaded){try{var a7=document.getElementById(this.id);a7.stopPlayback()}catch(a9){var a8="Player.stop :: "+a9;aG(a8);throw new Error(a8)}}else{this._play=false}};this.pause=function(){if(this.loaded){try{var a7=document.getElementById(this.id);a7.pausePlayback()}catch(a9){var a8="Player.pause :: "+a9;aG(a8);throw new Error(a8)}}else{this._play=false}}}function aV(a8){this.superClass=aD;this.superClass();this.apiKey=a8;this.panels={};this.showMicSettings=true;this.showCamSettings=true;var a5=360;var a7=270;var a4=340;var a6=230;this.detectDevices=function(){u("DeviceManager.detectDevices()");if(!a3){var bd={};bd.allowscriptaccess="always";a3="opentok_deviceDetector";var a9={};a9.id=a3;var ba={};aZ.onLoad(function(){var be=document.createElement("div");be.setAttribute("id",a3);be.style.display="none";document.body.appendChild(be);swfobject.embedSWF(G+"/v0.91.63/flash/f_devicedetectorwidget.swf?partnerId="+a8,a3,1,1,"10.0.0",false,ba,bd,a9)})}else{try{var bb=document.getElementById(a3);bb.detectDevices()}catch(bc){aG(bc);throw new Error("DeviceManager.detectDevices() :: Failed to locate existing device detector "+bc)}}};this.displayPanel=function(bc,bh,bd){u("DeviceManager.displayPanel("+bc+")");var br;if(bh){br="displayPanel_"+bh.id}else{br="displayPanel_global"}if(bh&&b.sessions){for(var bo in b.sessions){if(b.sessions[bo].hasOwnProperty("publishers")&&b.sessions[bo].publishers[bh.id]){b.sessions[bo].publishers[bh.id].panelId=br}}}var bm=document.getElementById(br);if(bm){a2("DeviceManager.displayPanel :: there is already a device panel"+(bh?" for this component":""));return this.panels[br]}var bg=false;var bj=(bd)?aP(bd):{};var bp={};bp.allowscriptaccess="always";var bn=a5;var bl=a7;if("showCloseButton" in bj){if(bj.showCloseButton==false){bn=a4;bl=a6}}else{bj.showCloseButton=true}if(!("showMicSettings" in bj)){bj.showMicSettings=this.showMicSettings}if(!("showCamSettings" in bj)){bj.showCamSettings=this.showCamSettings}if(!bc){bc="devicePanel_replace_div";var bi=document.createElement("div");bi.setAttribute("id",bc);var bb=document.createElement("div");bb.setAttribute("id","devicePanel_parent_"+(bh?bh.id:"global"));bb.style.position="absolute";var bf=("pageYOffset" in aU&&typeof(aU.pageYOffset)=="number")?aU.pageYOffset:(document.body&&document.body.scrollTop)?document.body.scrollTop:(document.documentElement&&document.documentElement.scrollTop)?document.documentElement.scrollTop:0;var ba=("innerHeight" in aU)?aU.innerHeight:(document.documentElement&&document.documentElement.offsetHeight)?document.documentElement.offsetHeight:a7;bf+=(ba*0.2);bb.style.top=bf+"px";bb.style.left="50%";bb.style.width=bn+"px";bb.style.height=bl+"px";bb.style.marginLeft=(0-bn/2)+"px";bb.style.marginTop=(0-bl/4)+"px";if("zIndex" in bj){bb.style.zIndex=bj.zIndex;delete bj.zIndex}else{bb.style.zIndex=af()+1}document.body.appendChild(bb);bg=true;bb.appendChild(bi)}var bk=document.getElementById(bc);if(!bk){var a9="DeviceManager.displayPanel :: replaceElementId does not exist in DOM.";aG(a9);throw new Error(a9)}var bq;if(this.panels[br]){this.removePanel(this.panels[br])}if(bh){bq=new au(br,bc,bh,bj)}else{bq=new au(br,bc,null,bj)}bq.parentCreated=bg;this.panels[br]=bq;var be={};be.id=bq.id;be.style="outline:none;";bj.devicePanelId=br;if(bj.wmode){bp.wmode=bj.wmode;delete bj.wmode}else{bp.wmode="transparent"}X(G+"/v0.91.63/flash/f_devicewidget.swf?partnerId="+this.apiKey,bc,bn,bl,A,false,bj,bp,be);return bq};this.removePanel=function(ba){var bg;if(!ba.hasOwnProperty("id")){bg="DeviceManager.removePanel :: invalid DevicePanel object";aG(bg);throw new Error(bg)}u("DeviceManager.removePanel("+ba.id+")");var bf=document.getElementById(ba.id);if(!bf){bg="DeviceManager.removePanel :: DevicePanel does not exist in DOM";aG(bg);throw new Error(bg)}var bi=bf.parentNode;var bh=ba.parentCreated;for(var bc in this.panels){if(this.panels[bc].hasOwnProperty("id")&&bc==ba.id){var a9=this.panels[bc];t(this.panels[bc]);delete this.panels[bc];var bd=function(){if(a9.publisher&&b.sessions){for(var bj in b.sessions){if(b.sessions[bj].hasOwnProperty("disconnect")&&b.sessions[bj].publishers[a9.publisher.id]){b.sessions[bj].publishers[a9.publisher.id].panelId=null}}}};setTimeout(bd,2)}}if(bh){try{var be=bi.parentNode;be.removeChild(bi)}catch(bb){bg="Failed to clean up the parent of the device panel "+bb;aG(bg);throw new Error(bg)}}}}function aS(a9){var a4=1;var a8=1;this.recorders={};this.players={};this.apiKey=a9;var a5=320;var a6=271;var a7=31;this.displayRecorder=function(ba,bf,be){if(!ba){errorMsg="RecorderManager.displayRecorder :: Token required to displayRecorder";aG(errorMsg);throw new Error(errorMsg)}var bi="recorder_"+a9+"_"+a4++;var bd=(be)?aP(be):{};bd.token=ba;bd.partnerId=a9;bd.recorderId=bi;if(bd.hasOwnProperty("style")){var bh=bd.style.showControlBar;bd.style=encodeURIComponent(V(bd.style))}var bb={};bb.allowscriptaccess="always";if(bd.wmode){bb.wmode=bd.wmode;delete bd.wmode}else{bb.wmode="transparent"}var bc={};bc.id=bi;bc.style="outline:none;";if(!bd.width||isNaN(bd.width)){bd.width=a5}if(!bd.height||isNaN(bd.height)){bd.height=a6;if(bh==false){bd.height-=a7}}var bg=false;if(!bf){bf="recorder_replace_"+a4;bg=true}aZ.onLoad(function(){if(bg){var bj=document.createElement("div");bj.setAttribute("id",bf);document.body.appendChild(bj)}X(G+"/v0.91.63/flash/f_recordwidget.swf?partnerId="+a9,bf,bd.width,bd.height,A,false,bd,bb,bc)});this.recorders[bi]=new aq(bi,bf,bd);return this.recorders[bi]};this.removeRecorder=function(ba){if(!ba){var bb="Session.removeRecorder :: recorder cannot be null";aG(bb);throw new Error(bb)}u("Session.removeRecorder("+ba.id+")");t(ba);delete this.recorders[ba.id]};this.displayPlayer=function(be,ba,bh,bg){if(!be){errorMsg="RecorderManager.displayPlayer :: Valid ArchiveId required";aG(errorMsg);throw new Error(errorMsg)}var bb="player_"+a9+"_"+a8++;var bf=(bg)?aP(bg):{};bf.token=ba;bf.archiveId=be;bf.partnerId=a9;bf.playerId=bb;if(bf.hasOwnProperty("style")){var bj=bf.style.showControlBar;bf.style=encodeURIComponent(V(bf.style))}var bc={};bc.allowscriptaccess="always";if(bf.wmode){bc.wmode=bf.wmode;delete bf.wmode}else{bc.wmode="transparent"}var bd={};bd.id=bb;bd.style="outline:none;";if(!bf.width||isNaN(bf.width)){bf.width=a5}if(!bf.height||isNaN(bf.height)){bf.height=a6;if(bj==false){bf.height-=a7}}if(!bf.autoPlay){bf.autoPlay=false}var bi=false;if(!bh){bh="player_replace_"+a8;bi=true}aZ.onLoad(function(){if(bi){var bk=document.createElement("div");bk.setAttribute("id",bh);document.body.appendChild(bk)}X(G+"/v0.91.63/flash/f_playerwidget.swf?partnerId="+a9,bh,bf.width,bf.height,A,false,bf,bc,bd)});this.players[bb]=new aM(bb,bh,bf);return this.players[bb]};this.removePlayer=function(ba){if(!ba){var bb="Session.removePlayer :: player cannot be null";aG(bb);throw new Error(bb)}u("Session.removePlayer("+ba.id+")");t(ba);delete this.players[ba.id]}}function Q(a9){this.superClass=aD;this.superClass();this.sessionId=a9;this.connection=null;this.subscribers={};this.publishers={};this.streams={};this.apiKey=null;this.capabilities=null;this.connected=false;this.connecting=false;var a7=1;var a4=264;var a5=198;var a6;var a8;this.connect=function(bh,bd,bc){if(this.connecting){a2("Session.connect :: Patience, please.");return}u("Session.connect("+bh+")");var be;if(!b.checkSystemRequirements()){be="Session.connect :: Flash Player Version 10+ required";aG(be);throw new Error(be)}if(!bh){be="Session.connect :: API key required to connect";aG(be);throw new Error(be)}if(!bd){be="Session.connect :: Token required to connect";aG(be);throw new Error(be)}if(this.connected){a2("Session.connect :: Session already connected");return}if(bd=="moderator_token"||bd=="devtoken"){a2('Session.connect :: "devtoken" and "moderator_token" are being deprecated soon. Please generate a token from http://www.tokbox.com/opentok/api/tools/generator')}this.connecting=true;var ba=(bc)?aP(bc):{};this.apiKey=bh;this.token=bd;this.properties=bc;var bg={};bg.allowscriptaccess="always";if(ba.wmode){bg.wmode=ba.wmode;delete ba.wmode}if(ba.connectionData){ba.connectionData=encodeURIComponent(ba.connectionData)}a6="controller_"+this.sessionId;var bb={};bb.id=a6;ba.sessionId=this.sessionId;ba.token=this.token;var bf="replace_"+this.sessionId;aZ.onLoad(function(){var bj=document.createElement("div");bj.setAttribute("id",bf);bj.style.display="none";document.body.appendChild(bj);var bi=new Date();ba.startTime=bi.getTime();swfobject.embedSWF(G+"/v0.91.63/flash/f_controllerwidget.swf?partnerId="+bh,bf,1,1,A,false,ba,bg,bb)});if(aU.location.protocol=="file:"){setTimeout("TB.controllerLoadCheck()",8000)}};this.disconnect=function(){u("Session.disconnect()");if(!a6||this.connecting){a2("Session.disconnect :: No connection to disconnect");return}var ba=document.getElementById(a6);if(ba){if(!isUnloading){try{ba.cleanupView()}catch(bc){var bb="Session.disconnect :: Failed to disconnect - "+bc;aG(bb);throw new Error(bb)}}}else{a2("Session.disconnect :: No connection to disconnect")}};this.disconnectComponents=function(){u("Session.disconnectComponents() - disconnecting publishers and subscribers");for(var bc in this.publishers){if(this.publishers[bc].hasOwnProperty("id")){try{this.unpublish(this.publishers[bc])}catch(bb){a2("disconnectComponents:: Failed to unpublish publisher "+bc)}}}for(var ba in this.subscribers){if(this.subscribers[ba].hasOwnProperty("id")){try{at(this.subscribers[ba])}catch(bb){a2("disconnectComponent:: Failed to disconnect subscriber "+ba)}}}};this.cleanup=function(){u("Session.cleanup()");for(var bc in this.publishers){if(this.publishers[bc].hasOwnProperty("id")){try{this.unpublish(this.publishers[bc]);if(this.publishers[bc]._.DOMcomponent){this.publishers[bc].destroy()}}catch(bb){a2("cleanup:: Failed to unpublish publisher "+bc)}}}for(var ba in this.subscribers){if(this.subscribers[ba].hasOwnProperty("id")){this.unsubscribe(this.subscribers[ba])}}this.publishers={};this.subscribers={};a8=undefined};this.cleanupConnection=function(){u("Session.cleanupConnection() - removing controller");this.connection=null;if(!a6){a2("Session.cleanup :: No connection to clean up");return}if(document.getElementById(a6)){setTimeout(function(){aF(a6,"TB.sessionDisconnected :: ");a6=null},0)}else{a2("Session.cleanup :: No connection to clean up")}};this.publish=function(bc,ba){u("Session.publish("+bc+"):"+ba);var bb;if(!this.connection||!this.connection.connectionId){bb="Session.publish :: Connection required to publish";aG(bb);throw new Error(bb)}if(!bc||typeof(bc)==="string"){bc=b.initPublisher(this.apiKey,bc,k(ba,{sessionId:this.sessionId,connectionId:this.connection.connectionId,token:this.token}))}else{if(bc instanceof U){if("session" in bc&&bc.session&&"sessionId" in bc.session){if(bc.session.sessionId===this.sessionId){a2("Cannot publish "+bc.id+" again to "+this.sessionId+". Please call session.unpublish(publisher) first.")}else{a2("Cannot publish "+bc.id+" publisher already attached to "+bc.session.sessionId+". Please call session.unpublish(publisher) first.")}return bc}bc._.publishToSession(this.sessionId,this.connection.connectionId,this.token)}else{bb="Session.publish :: First parameter passed in is neither a string nor an instance of the Publisher";aG(bb);throw new Error(bb)}}this.publishers[bc.id]=bc;bc.session=this;return bc};this.unpublish=function(ba){if(!ba){throw new Error("Session.unpublish :: publisher parameter missing, publisher cannot be null")}else{if(!ba.hasOwnProperty("_")||!ba._.hasOwnProperty("unpublishFromSession")){throw new Error("Session.unpublish :: unknown publisher type, publisher must be created with TB.initPublisher()")}}if(ba.session&&ba.session.sessionId==this.sessionId){ba._.unpublishFromSession(this.sessionId)}else{if(!ba.session){ba.destroy()}else{if(ba.session.sessionId!=this.sessionId){a2("The publisher "+ba.id+" is trying to unpublish from a session "+this.sessionId+" it is not attached to")}}}if(ba.panelId&&v&&v.panels[ba.panelId]){v.removePanel(v.panels[ba.panelId])}ba.session=null};this.forceUnpublish=function(be){var bd,bc;if(be&&typeof(be)=="string"){bd=be}else{if(be&&typeof(be)=="object"&&be.hasOwnProperty("streamId")){bd=be.streamId}else{bc="Session.forceUnpublish :: Invalid stream type";aG(bc);throw new Error(bc)}}if(!this.streams[bd]){b.exceptionHandler("Call to forceUnpublish() failed. The specified stream is not publishing to the session.","Force Unpublish on Invalid Stream",1535);return}u("Session.forceUnpublish("+bd+")");if(bd){try{var ba=document.getElementById(a6);ba.forceUnpublish(bd)}catch(bb){bc="Session.forceUnpublish :: "+bb;aG(bc);throw new Error(bc)}}else{bc="Session.forceUnpublish :: Stream does not exist.";aG(bc);throw new Error(bc)}};this.subscribe=function(bk,bh,bg){var bf;if(!this.connection||!this.connection.connectionId){bf="Session.subscribe :: Connection required to subscribe";aG(bf);throw new Error(bf)}if(!bk){bf="Session.subscribe :: stream cannot be null";aG(bf);throw new Error(bf)}if(!bk.hasOwnProperty("streamId")){bf="Session.subscribe :: invalid stream object";aG(bf);throw new Error(bf)}u("Session.subscribe("+bk.streamId+")");if(!bh){var ba=document.createElement("div");bh="subscriber_replace_"+this.sessionId+"_"+a7;ba.setAttribute("id",bh);document.body.appendChild(ba)}var bc=document.getElementById(bh);if(!bc){bf="Session.subscribe :: replaceElementId does not exist in DOM.";aG(bf);throw new Error(bf)}var be=(bg)?aP(bg):{};var bi="subscriber_"+bk.streamId+"_"+a7++;var bl=new ah(bk,bi,bh,be);var bb={};bb.allowscriptaccess="always";if(be.wmode){bb.wmode=be.wmode;delete be.wmode}else{bb.wmode="transparent"}if(be.hasOwnProperty("style")){be.style=encodeURIComponent(V(be.style))}var bd={};bd.id=bl.id;bd.style="outline:none;";be.subscriberId=bi;be.connectionId=this.connection.connectionId;be.sessionId=this.sessionId;be.streamId=bk.streamId;be.streamType=bk.type;be.name=bk.name;be.token=this.token;be.simulateMobile=b.simulateMobile;be.isPublishing=(Object.keys(this.publishers).length>0);if(!bk.hasAudio){be.subscribeToAudio="false"}if(!bk.hasVideo){be.subscribeToVideo="false"}be.orientation=bk.orientation;be.peerId=bk.peerId;if(!be.width||isNaN(be.width)){be.width=a4}if(!be.height||isNaN(be.height)){be.height=a5}this.subscribers[bl.id]=bl;var bj=new Date();be.startTime=bj.getTime();X(G+"/v0.91.63/flash/f_subscribewidget.swf?partnerId="+this.apiKey,bh,be.width,be.height,A,false,be,bb,bd);return bl};this.unsubscribe=function(ba){if(!ba){var bb="Subscribe.unsubscribe :: subscriber cannot be null";aG(bb);throw new Error(bb)}u("Session.unsubscribe("+ba.id+")");t(ba);delete this.subscribers[ba.id]};this.signal=function(){u("Session.signal()");var bc;if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.sendSignal()}catch(bb){bc="Session.signal :: "+bb;aG(bc);throw new Error(bc)}}else{bc="Session.signal :: Connection required to signal.";aG(bc);throw new Error(bc)}};this.forceDisconnect=function(bb){if(bb){u("Session.forceDisconnect("+bb.connectionId+")")}var be,bd;if(bb&&typeof(bb)=="string"){be=bb}else{if(bb&&typeof(bb)=="object"&&bb.hasOwnProperty("connectionId")){be=bb.connectionId}else{bd="Session.forceDisconnect :: Invalid connection type";aG(bd);throw new Error(bd)}}if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.forceDisconnect(be)}catch(bc){bd="Session.forceDisconnect :: "+bc;aG(bd);throw new Error(bd)}}else{bd="Session.forceDisconnect :: Connection required to forceDisconnect.";aG(bd);throw new Error(bd)}};this.getSubscribersForStream=function(be){var ba=null,bc;if(!be){bc="Session.getSubscribersForStream :: stream cannot be null";aG(bc);throw new Error(bc)}else{var bd;if(typeof(be)=="string"){bd=be}else{if(typeof(be)=="object"&&be.hasOwnProperty("streamId")){bd=be.streamId}else{bc="Session.getSubscribersForStream :: Invalid stream type";aG(bc);throw new Error(bc)}}ba=[];for(var bb in this.subscribers){if(this.subscribers[bb].hasOwnProperty("stream")&&this.subscribers[bb].stream.streamId==bd){ba.push(this.subscribers[bb])}}}return ba};this.getPublisherForStream=function(bg){var be;if(!bg){be="Session.getPublisherForStream :: stream cannot be null";aG(be);throw new Error(be)}else{var bf;if(typeof(bg)=="string"){bf=bg}else{if(typeof(bg)=="object"&&bg.hasOwnProperty("streamId")){bf=bg.streamId}else{be="Session.getPublisherForStream :: Invalid stream type";aG(be);throw new Error(be)}}for(var bd in this.publishers){var bc=this.publishers[bd];if(bc){try{var ba=bc._.callFlash("getStreamId",[],{silentError:true});if(ba===bf){return this.publishers[bd]}if(!ba){a2("Failed to get streamId for publisher: "+this.publishers[bd].id);delete this.publishers[bd]}}catch(bb){a2("Failed to get streamId for publisher: "+this.publishers[bd].id);delete this.publishers[bd]}}else{a2("Removing unknown publisher from stream");delete this.publishers[bd]}}}return null};this.createArchive=function(be,bb,bd){u("Session.createArchive()");if(a6&&this.connection&&this.connection.connectionId){if(bb==b.PER_SESSION||bb==b.PER_STREAM){try{var ba=document.getElementById(a6);ba.createArchive(be,bb,bd)}catch(bc){errorMsg="Session.createArchive :: "+bc;aG(errorMsg);throw new Error(errorMsg)}}else{errorMsg="Session.createArchive :: Invalid type specfied.";aG(errorMsg);throw new Error(errorMsg)}}else{errorMsg="Session.createArchive :: Connection required to create an archive.";aG(errorMsg);throw new Error(errorMsg)}};this.loadArchive=function(bd){u("Session.loadArchive()");var bc;if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.loadArchive(bd)}catch(bb){bc="Session.loadArchive :: "+bb;aG(bc);throw new Error(bc)}}else{bc="Session.loadArchive :: Connection required to load an archive.";aG(bc);throw new Error(bc)}};this.startRecording=function(bb){u("Session.startRecording()");bb=H[this.sessionId][bb.archiveId];var bd;if(!bb){bd="Session.startRecording :: Archive not created.";aG(bd);throw new Error(bd)}if(bb.type!=b.PER_SESSION){bd="Session.startRecording :: Trying to record per session on a "+bb.type+" archive";aG(bd);throw new Error(bd)}if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.startRecordingSession(bb.archiveId)}catch(bc){bd="Session.startRecording :: "+bc;aG(bd);throw new Error(bd)}}else{bd="Session.startRecording :: Connection required to record an archive.";aG(bd);throw new Error(bd)}};this.stopRecording=function(bb){u("Session.stopRecording()");bb=H[this.sessionId][bb.archiveId];var bd;if(!bb){bd="Session.stopRecording :: Archive not created.";aG(bd);throw new Error(bd)}if(bb.type!=b.PER_SESSION){bd="Session.stopRecording :: Trying to stop recording per session on a "+bb.type+" archive";aG(bd);throw new Error(bd)}if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.stopRecordingSession(bb.archiveId)}catch(bc){bd="Session.stopRecording :: "+bc;aG(bd);throw new Error(bd)}}else{bd="Session.stopRecording :: Connection required to record an archive.";aG(bd);throw new Error(bd)}};this.closeArchive=function(bb){u("Session.closeArchive()");var bd;if(a6&&this.connection&&this.connection.connectionId){try{var ba=document.getElementById(a6);ba.closeArchive(bb.archiveId)}catch(bc){bd="Session.closeArchive :: "+bc;aG(bd);throw new Error(bd)}}else{bd="Session.closeArchive :: Connection required to close an archive.";aG(bd);throw new Error(bd)}};this.getStateManager=function(){u("Session.getStateManager()");if(a8){return a8}else{if(a6&&this.connection&&this.connection.connectionId){a8=new T(a6);return a8}}var ba="Session.getStateManager :: Connection required to getState. Wait for sessionConnected before you getStateManager.";aG(ba);throw new Error(ba)}}function T(a5,a6){this.superClass=aD;this.superClass();var a4=20;this.archiveId=a6;this.set=function(ba,bd){var a9=ba,bc;if(a6){bc="StateManager.set :: not allowed on StateManager objects for archives.";aG(bc);throw new Error(bc)}if(typeof(ba)==="string"&&(typeof(bd)==="string"||bd==null)){a9={};a9[ba]=bd}else{if(typeof(ba)==="object"&&bd==null){if(Object.keys(a9).length>a4){aG("StateManager.set :: Maximum number of keys exceeded");this.dispatchEvent(new ar("changeFailed",405,"Maximum number of keys exceeded",a9));return}}else{bc="StateManager.set :: Invalid parameters passed. set() takes either two string parameters or one object of key value pairs.";aG(bc);throw new Error(bc)}}for(var a8 in a9){if(typeof(a9[a8])!=="string"&&a9[a8]!=null){aG("StateManager.set :: Invalid value "+a9[a8].toString()+" is not a string");this.dispatchEvent(new ar("changeFailed",403," Invalid value, value must be a string",a9));return}}if(a5){try{var a7=document.getElementById(a5);a7.setState(a9)}catch(bb){bc="StateManager.set :: "+bb;aG(bc);throw new Error(bc)}}};this.superAddEventListener=this.addEventListener;this.addEventListener=function(bb,be){var a9=false;if(bb=="changed"){a9=null}else{if(bb.indexOf("changed:")===0){a9=bb.split(":")[1]}}if(a9!==false){if(a6){a9="TB_archive_"+a6+"_"}if(a5){try{var a8=document.getElementById(a5);var a7=a8.subscribeToKeyChange(a9);if(a7!=null){var ba=av(be,new al(a9?"changed:"+a9:"changed",a7));setTimeout(ba,1)}}catch(bd){var bc="StateManager.addEventListener :: "+bd;aG(bc);throw new Error(bc)}}}this.superAddEventListener(bb,be)}}var S=(function(){var a7="http://hlg.tokbox.com/prod/logging/ClientEvent",a9="opentok-logging-frame",a8={},a6={payloadType:"payload_type",streamId:"stream_id",sessiondId:"sessiond_id",connectionId:"connection_id",widgetType:"widget_type",widgetId:"widget_id"},bb=swfobject?swfobject.getFlashPlayerVersion():null,a4=bb?[bb.major,bb.minor,bb.release].join("."):"none",a5=function(be){var bd=document.getElementById("opentok_analytics_logging");if(bd&&bd.parentNode){bd.parentNode.removeChild(bd)}bd=ak("form",{id:"opentok_analytics_logging",action:a7,method:"post",target:a9,style:"display:none;"});for(var bc in be){if(be.hasOwnProperty(bc)){a0(bd,bc,be[bc])}}document.body.appendChild(bd);return bd},ba=function(bf,be,bg){if(!bg){return false}var bc=[bg,be,bf].join("_"),bd=aO.get("exceptionLogging","messageLimitPerPartner",bg);if(bd===null||bd===undefined){return false}return(a8[bc]||0)<=bd};return{error:function(bh,bf,bg,be,bd){if(!bd){bd={}}var bj=bd.partnerId;if(aO.get("exceptionLogging","enabled",bj)!==true){return}if(ba(bh,bf,bj)){b.log("ClientEvents.error has throttled an error of type "+bf+"."+bh+" for partner "+(bj||"No Partner Id"));return}var bc=[bj,bf,bh].join("_"),bi=this.escapePayload(D(be,{message:bg,userAgent:navigator.userAgent,flashVersion:a4}));a8[bc]=typeof(a8[bc])!=="undefined"?a8[bc]+1:1;return this.log(D(bd,{action:bf+"."+bh,payloadType:bi[0],payload:bi[1]}))},log:function(bc){var bh=bc.partnerId;if(!bc){bc={}}var be,bf=D({variation:"",guid:"",widgetId:"",sessionId:"",connectionId:"",streamId:"",partnerId:"",source:aU.location.href,section:"",build:""},bc),bg=function(){b.log("logged: {action: "+bf.action+", variation: "+bf.variation+", payload_type: "+bf.payload_type+", payload: "+bf.payload+"}")};for(var bd in a6){if(a6.hasOwnProperty(bd)&&bf[bd]){bf[a6[bd]]=bf[bd];delete bf[bd]}}be=a5(bf);Z(a9,be,{removeFormOnComplete:true,onComplete:bg})},escapePayload:function(bf){var be=[],bc=[];for(var bd in bf){if(bf.hasOwnProperty(bd)&&bf[bd]!==null&&bf[bd]!==undefined){be.push(bf[bd]?bf[bd].toString().replace("|","\\|"):"");bc.push(bd.toString().replace("|","\\|"))}}return[bc.join("|"),be.join("|")]}}})();function aE(){this.superClass=aD;this.superClass();var a5=false,a7=false,a4=this,ba=function(){return a7&&a5},a8=function(){if(ba()){a4.dispatchEvent(new N("envLoaded"))}},bb=function(){a7=true;aO.load();a8()},a6=function(){a5=true;aO.removeEventListener("dynamicConfigChanged",a6);aO.removeEventListener("dynamicConfigLoadFailed",a9);a8()},a9=function(){a6()};swfobject.addDomLoadEvent(bb);aO.addEventListener("dynamicConfigChanged",a6);aO.addEventListener("dynamicConfigLoadFailed",a9);this.onLoad=function(bc){if(ba()){bc();return}this.addEventListener("envLoaded",bc)}}function p(a4){if(!a4.success){aG("Failed to embed SWF "+a4.id);b.exceptionHandler("Failed to embed SWF "+a4.id,"Embed Failed",2001)}}function X(a7,bc,a9,bb,a4,a6,a5,a8,ba){if(!swfobject.hasFlashPlayerVersion(a4)){aG("Flash Player "+a4+" or higher required");b.exceptionHandler("Flash Player "+a4+" or higher required","Embed Failed",2001);return}swfobject.embedSWF(a7,bc,a9,bb,a4,a6,a5,a8,ba,p)}function av(a5,a4){return function(){if(a5!=null){a5(a4)}else{aG("Event handler is null")}}}function aB(a4){aU.opentokdebug.debug("[FLASHDEBUG] opentok: "+a4)}function u(a4){aU.opentokdebug.debug("[DEBUG] opentok: "+a4)}function r(a4){aU.opentokdebug.info("[INFO] opentok: "+a4)}function a2(a4){aU.opentokdebug.warn("[WARN] opentok: "+a4)}function aG(a4){aU.opentokdebug.error("[ERROR] opentok: "+a4)}function aN(a7,a5,a6){var a4=document.getElementById("opentok_console");if(a4){a4.innerHTML+=(a6+"<br>")}}function d(a4){if(ag.hasOwnProperty(a4)){return ag[a4]}else{return new R(a4,NaN,null)}}function E(a4,a7){var a6=a4.streamId;var a5=b.sessions[a7];if(a5){if(a5.streams[a6]){return a5.streams[a6]}else{var a8=new ae(a6,d(a4.connectionId),a4.name,a4.streamData,a4.type,a4.creationTime,a4.hasAudio,a4.hasVideo,a4.orientation,a7,a4.peerId,a4.quality);a5.streams[a6]=a8;return a8}}return null}function f(a5,a6){var a7=[];for(var a4=0;a4<a5.length;a4++){a7.push(E(a5[a4],a6))}return a7}function s(a4,a5){var a6=new C(a4.id,a4.type,a4.title,a5,a4.status);if(!H.hasOwnProperty(a5)){H[a5]={}}H[a5][a4.id]=a6;return a6}function ay(a5){var a7=[];for(var a6=0;a6<a5.length;a6++){var a4=new R(a5[a6].connectionId,a5[a6].creationTime,a5[a6].data);a7.push(a4);ag[a4.connectionId]=a4}return a7}function ad(a4){if(a4.status==b.ACTIVE){return new aX(a4.name,b.ACTIVE)}else{if(a4.status==b.INACTIVE){return new aX(a4.name,b.INACTIVE)}else{return new aX(a4.name,b.UNKNOWN)}}}function P(a4){return new aT(a4.name,a4.status)}function J(a4){var a6=new Array();for(var a5=0;a5<a4.length;a5++){a6.push(new aX(a4[a5].name,a4[a5].status))}return a6}function I(a4){var a6=new Array();for(var a5=0;a5<a4.length;a5++){a6.push(new aT(a4[a5].name,a4[a5].status))}return a6}function at(a4){if(!a4.hasOwnProperty("id")){return}var a5=document.getElementById(a4.id);if(a5){try{a5.cleanupView()}catch(a6){a2("Disconnecting "+a4.id+" failed")}}else{a2("Disconnecting "+a4.id+" failed")}}function t(a5){var a6=document.getElementById(a5.id);if(a6){try{a6.cleanupView();var a4=a6.parentNode;a4.removeChild(a6)}catch(a7){a2("Removing "+a5.id+" failed "+a7)}}else{a2("Element "+a5.id+" does not exist")}}function aF(a4,a7){try{if(a4){swfobject.removeSWF(a4);a4=null}}catch(a6){var a5=a7+a6;aG(a5);b.exceptionHandler(a5,"Internal Error",2000)}}function l(a9,a8,a7){var a4=document.getElementById(a9);if(a4){try{a4.setStreamProperty(a8,a7)}catch(a6){var a5="Changing settings on component "+a9+" failed.";aG(a5);throw new Error(a5)}}else{a5="Component "+a9+" does not exist.";aG(a5);throw new Error(a5)}}function i(a9,a8,a4){var a5=document.getElementById(a9);if(a5){try{if(a4){a5.setCamera(a8.name)}else{a5.setMicrophone(a8.name)}}catch(a7){var a6="Changing hardware settings on publisher "+a9+" failed.";aG(a6);throw new Error(a6)}}else{a6="Publisher "+a9+" does not exist.";aG(a6);throw new Error(a6)}}function af(ba,a7){a7=a7||Infinity;ba=ba||document.body;var bb,bc,a9=1,a6=[],a8=0;var a5=ba.childNodes,a4=a5.length;while(a8<a4){bb=a5[a8++];if(bb.nodeType!=1){continue}if(aa(bb,"position")!=="static"){bc=aa(bb,"z-index");if(bc=="auto"){bc=af(bb)}else{bc=parseInt(bc,10)||0}}else{bc=af(bb)}if(bc>a9&&bc<=a7){a9=bc}}return a9}function aa(a7,a6){var a4,a8,a5=document.defaultView||aU;if(a7.nodeType==1){a4=a6.replace(/\-([a-z])/g,function(ba,a9){return a9.toUpperCase()});a8=a7.style[a4];if(!a8){if(a7.currentStyle){a8=a7.currentStyle[a4]}else{if(a5.getComputedStyle){a8=a5.getComputedStyle(a7,"").getPropertyValue(a6)}}}}return a8||""}function D(a4,a6){for(var a5 in a6){if(a6.hasOwnProperty(a5)){a4[a5]=a6[a5]}}return a4}function ak(a6,a5){var a7=document.createElement(a6);for(var a4 in a5){a7.setAttribute(a4,a5[a4])}return a7}function a0(a6,a5,a7){var a4=document.createElement("textarea");a4.setAttribute("name",a5);a4.value=a7;a4.style.display="none";a6.appendChild(a4)}function x(a6){var a5=a6.width||390;var a4=a6.height||242;var a7=document.createElement("div");a7.setAttribute("id",a6.id||"modalDiv"+(Math.random()*(99999999)));a7.style.position="absolute";a7.style.top="25%";a7.style.left="50%";a7.style.width=a5+"px";a7.style.height=a4+"px";a7.style.marginLeft=(0-a5/2)+"px";a7.style.marginTop=(0-a4/4)+"px";a7.style.paddingLeft="32px";a7.style.paddingRight="15px";a7.style.paddingTop="15px";a7.style.display="block";a7.style.visibility="visible";a7.style.lineHeight="15px";a7.style.zIndex=af()+1;a7.innerHTML=a6.innerHTML||"";a7.style.backgroundColor="#F7F7F7";a7.style.border="1px solid #CCC";a7.style.fontWeight="normal";a7.style.fontFamily="'Lucida Grande', 'Trebuchet MS', sans-serif";a7.style.color="#4c4c4c";a7.style.fontSize="13px";return a7}function aR(a5){a5.width=a5.width||390;a5.height=a5.height||242;var a7=x(a5);var a6=document.createElement("input");a6.setAttribute("type","button");a6.setAttribute("value","Close");a6.style.display="inline";a6.style.visibility="visible";a6.style.width="100px";a6.style.position="absolute";a6.style.bottom="10px";var a4=parseInt(a7.style.paddingLeft,10)+parseInt(a7.style.paddingRight,10);a6.style.left=(a5.width+a4)/2-50+"px";a6.onclick=function(){if(a7.parentNode){a7.parentNode.removeChild(a7)}};a7.appendChild(a6);document.body.appendChild(a7)}function F(a9){var a6=[];var a8=new Array(48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70);var ba=45;var a7=a9||new Array(8,4,4,4,12);for(var a5=0;a5<a7.length;a5++){for(var a4=0;a4<a7[a5];a4++){a6.push(a8[Math.floor(Math.random()*a8.length)])}}return String.fromCharCode.apply(null,a6)}function Z(a9,a8,a6){if(!a6){a6={}}var a4=false,a7=function(){if(a4){return}a4=true;if(a6.onSubmit&&a8){if(a8.addEventListener){a8.addEventListener("submit",a6.onSubmit(),false)}else{if(element.attachEvent){a8.attachEvent("onsubmit",a6.onSubmit())}}}a8.submit();setTimeout(function(){var ba=document.getElementById(a9);if(ba){ba.parentNode.removeChild(ba)}if(a6.removeFormOnComplete===true&&a8.parentNode){a8.parentNode.removeChild(a8)}if(a6.onComplete){a6.onComplete()}},1000)};a8.setAttribute("target",a9);if(!document.getElementById(a9)){var a5=ak("iframe",{id:a9,name:a9,style:"display:none;width:0;height:0;"});a5.onload=a7;document.body.appendChild(a5);if(a5.attachEvent){a5.attachEvent("onload",a7)}}else{a7()}}function az(a4){try{var a5=document.getElementById(a4);if(a5){return a5.fetchData()}}catch(a6){a2("Failed to get logs for "+a4+" "+a6);return""}}function V(a5){var a4="{ ";for(var a6 in a5){if(typeof(a5[a6])=="boolean"){a4+='"'+a6+'":'+a5[a6]+", "}else{a4+='"'+a6+'":"'+a5[a6].toString()+'", '}}if(a4.length>1){a4=a4.substring(0,a4.length-2)+" }"}else{a4="{}"}return a4}function aP(a6){var a4=(a6 instanceof Array)?[]:{};for(var a5 in a6){if(a5=="clone"){continue}if(a6[a5]&&typeof a6[a5]=="object"){a4[a5]=aP(a6[a5])}else{a4[a5]=a6[a5]}}return a4}function k(a6,a5){var a4,a8={};if(typeof(a6)==="object"&&typeof(a5)==="object"){for(a4 in a6){if(a6.hasOwnProperty(a4)){a8[a4]=a6[a4];if(a4 in a5){a8[a4]=k(a6[a4],a5[a4])}}}for(a4 in a5){if(a5.hasOwnProperty(a4)){if(!(a4 in a6)){a8[a4]=a5[a4]}}}}else{a8=a5}if(arguments.length>2){var a7=Array.prototype.slice.call(arguments);a7=a7.slice(2);a7.unshift(a8);return k.apply(this,a7)}return a8}this.isUnloading=false;aU.onunload=function(){isUnloading=true;for(var a4 in b.sessions){if(b.sessions[a4].hasOwnProperty("disconnect")){b.sessionDisconnectedHandler=function(){};b.sessions[a4].disconnect();b.sessions[a4].cleanupConnection();b.sessions[a4].cleanup()}}};M=new aD();var q,h=document.location.hash;var b={sessions:{},LOG:5,DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0,ACTIVE:"active",INACTIVE:"inactive",UNKNOWN:"unknown",PER_SESSION:"perSession",PER_STREAM:"perStream",EXCEPTION:"exception",ISSUE_REPORTED:"issueReported",SESSION_CONNECTED:"sessionConnected",SESSION_DISCONNECTED:"sessionDisconnected",STREAM_CREATED:"streamCreated",STREAM_DESTROYED:"streamDestroyed",CONNECTION_CREATED:"connectionCreated",CONNECTION_DESTROYED:"connectionDestroyed",SIGNAL_RECEIVED:"signalReceived",STREAM_PROPERTY_CHANGED:"streamPropertyChanged",MICROPHONE_LEVEL_CHANGED:"microphoneLevelChanged",ARCHIVE_CREATED:"archiveCreated",ARCHIVE_CLOSED:"archiveClosed",ARCHIVE_LOADED:"archiveLoaded",ARCHIVE_SAVED:"archiveSaved",SESSION_RECORDING_STARTED:"sessionRecordingStarted",SESSION_RECORDING_STOPPED:"sessionRecordingStopped",SESSION_RECORDING_IN_PROGRESS:"sessionRecordingInProgress",STREAM_RECORDING_IN_PROGRESS:"streamRecordingInProgress",SESSION_NOT_RECORDING:"sessionNotRecording",STREAM_NOT_RECORDING:"streamNotRecording",STREAM_RECORDING_STARTED:"streamRecordingStarted",STREAM_RECORDING_STOPPED:"streamRecordingStopped",PLAYBACK_STARTED:"playbackStarted",PLAYBACK_PAUSED:"playbackPaused",PLAYBACK_STOPPED:"playbackStopped",RECORDING_STARTED:"recordingStarted",RECORDING_STOPPED:"recordingStopped",RESIZE:"resize",SETTINGS_BUTTON_CLICK:"settingsButtonClick",DEVICE_INACTIVE:"deviceInactive",INVALID_DEVICE_NAME:"invalidDeviceName",ACCESS_ALLOWED:"accessAllowed",ACCESS_DENIED:"accessDenied",ECHO_CANCELLATION_MODE_CHANGED:"echoCancellationModeChanged",DEVICES_DETECTED:"devicesDetected",DEVICES_SELECTED:"devicesSelected",CLOSE_BUTTON_CLICK:"closeButtonClick",MICLEVEL:"microphoneActivityLevel",MICGAINCHANGED:"microphoneGainChanged",HAS_REQUIREMENTS:1,OLD_FLASH_VERSION:0,BASIC_STREAM:"basic",ARCHIVED:"archive",simulateMobile:false,$:{createModalDiv:x,tbAlert:aR},setLogLevel:function(a4){aU.opentokdebug.setLevel(a4);if(a4==this.NONE){aU.opentokdebug.setCallback(null)}else{aU.opentokdebug.setCallback(aN,true,0);if(a4>=this.DEBUG&&!z){u("OpenTok JavaScript library v0.91.63");u("Release notes: http://www.tokbox.com/opentok/api/tools/js/documentation/overview/releaseNotes.html");u("Known issues: http://www.tokbox.com/opentok/api/tools/js/documentation/overview/releaseNotes.html#knownIssues");z=true}}u("TB.setLogLevel("+a4+")")},reportIssue:function(a5){if(aH){return}u("TB.reportIssue");var a6=F();if(a5&&a5.length>300){a5=a5.substr(0,300)}try{this.reportIssueHandler(a6,false,a5,true);aH=true}catch(a4){aH=false}},log:function(a4){aU.opentokdebug.log("[LOG] opentok: "+a4)},ClientEvents:S,Config:{get:function(){return aO.get.apply(aO,arguments)}},initSession:function(a5){u("TB.initSession("+a5+")");if(a5==null||a5===""){var a4="TB.initSession :: sessionId cannot be null";aG(a4);throw new Error(a4)}if(!this.sessions.hasOwnProperty(a5)){this.sessions[a5]=new Q(a5)}if(!ap.hasOwnProperty(a5)){ap[a5]=this.sessions[a5]}return this.sessions[a5]},initPublisher:function(a6,a4,a5){u("TB.initPublisher("+a4+")");if(!a5||typeof(a5)!=="object"){a5={}}a5.apiKey=a6;return new U("publisher_"+ab++,a4,a5)},initDeviceManager:function(a5){u("TB.initDeviceManager("+a5+")");if(!a5){var a4="TB.initDeviceManager :: apiKey cannot be null";aG(a4);throw new Error(a4)}if(!v){v=new aV(a5)}return v},initRecorderManager:function(a5){u("TB.initRecorderManager("+a5+")");if(!a5){var a4="TB.initRecorderManager :: apiKey cannot be null";aG(a4);throw new Error(a4)}if(!B){B=new aS(a5)}return B},addEventListener:function(a4,a5){u("TB.addEventListener("+a4+")");M.addEventListener(a4,a5)},removeEventListener:function(a4,a5){u("TB.removeEventListener("+a4+")");M.removeEventListener(a4,a5)},dispatchEvent:function(a4){u("TB.dispatchEvent()");a4.target=this;M.dispatchEvent(a4)},checkSystemRequirements:function(){u("TB.checkSystemRequirements()");var a4=A,a5=Array.prototype.slice.call(arguments),a7=["h264","aec"];for(var a6=0;a6<a5.length;a6++){if(typeof(a5[a6])!=="string"||a7.indexOf(a5[a6].toLowerCase())===-1){aG("Invalid argument passed to TB.checkSystemRequirements: Permitted parameters are "+a7.join(", ")+"; received '"+a5[a6]+"'")}else{a5[a6]=a5[a6].toLowerCase()}}if(a5.indexOf("h264")>-1){a4="11"}else{if(a5.indexOf("aec")>-1){a4="10.3"}}return swfobject.hasFlashPlayerVersion(a4)?this.HAS_REQUIREMENTS:this.OLD_FLASH_VERSION},upgradeSystemRequirements:function(){aZ.onLoad(function(){var a4="_upgradeFlash";document.body.appendChild((function(){var a5=document.createElement("iframe");a5.id=a4;a5.style.position="absolute";a5.style.position="fixed";a5.style.height="100%";a5.style.width="100%";a5.style.top="0px";a5.style.left="0px";a5.style.right="0px";a5.style.bottom="0px";a5.src=G+"/v0.91.63/html/upgradeFlash.html#"+encodeURIComponent(document.location.href);return a5})());q&&clearInterval(q);q=setInterval(function(){var a6=document.location.hash,a5=/^#?\d+&/;if(a6!==h&&a5.test(a6)){h=a6;if(a6.replace(a5,"")==="close_window"){document.body.removeChild(document.getElementById(a4));document.location.hash=""}}},100)})},dynamicConfigLoadedHandler:function(a4){aO.replaceWith(a4)},_exceptionHandler:function(a4,ba,a8,a5){var a9=e[a8],a6=a5?aP(a5):{};aG("TB.exception :: title: "+a9+" ("+a8+") msg: "+ba);if(!a6.partnerId){if(v||B){a6.partnerId=(v||B).apiKey}if(!a6.partnerId){aG("TB._exceptionHandler called but could not find a partner ID.")}}try{S.error(a8,"tb.exception",a9,{details:ba},a6);this.dispatchEvent(new K(this.EXCEPTION,ba,a9,a8,a4))}catch(a7){aG("TB.exception :: Failed to dispatch exception - "+a7.toString())}},handleJsException:function(a7,a6,a4){if(a4&&!a4.target){a4.target=null}var a5,a8=a4.session;if(a8){a5={sessionId:a8.sessionId,partnerId:a8.apiKey};if(a8.connected){a5.connectionId=a8.connection.connectionId}}this._exceptionHandler(a4.target,a7,a6,a5)},exceptionHandler:function(a5,a9,a4,a8,a6){var a7;if(a5){a7=ap[a5];if(!a7){a2("Could not find the component with component ID "+a5)}}this._exceptionHandler(a7,a9,a8,a6)},controllerLoadedHandler:function(){aK=true},controllerLoadCheck:function(a5){if(!aK){var a4="The connection timed out. Make sure that you have allowed this page in theFlash Player Global Settings Manager. Go to:";adobeURL="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html";prompt(a4,adobeURL)}},flashLogger:function(a4){aB(a4)},sessionConnectedHandler:function(bb,bc,a4,a7,a5,bg,be){u("TB.sessionConnected: "+bb+" - "+bc);var bd=this.sessions[bb],a6,ba;try{for(ba=0,len=a4.length;ba<len;ba++){a6=a4[ba];if(a6.connectionId===bc){bd.connection=new R(bc,a6.creationTime,a6.data);break}}bd.connected=true;bd.connecting=false;bd.connection.quality=bg;bd.capabilities=a5;var bi=ay(a4);var bh=f(a7,bd.sessionId);var bf=[];for(ba=0;ba<be.length;ba++){var a8=s(be[ba],bb);bf.push(a8)}bd.dispatchEvent(new aY(this.SESSION_CONNECTED,bi,bh,bf))}catch(a9){b.handleJsException("TB.sessionConnected :: "+a9,2000,{session:bd,target:bd})}},sessionDisconnectedHandler:function(a9,a8){u("TB.sessionDisconnected("+a8+")");var a7=this.sessions[a9];try{a7.disconnectComponents();a7.cleanupConnection();a7.connected=false;var a6=new y(this.SESSION_DISCONNECTED,a8,true);a7.dispatchEvent(a6)}catch(a5){b.handleJsException("TB.sessionDisconnected :: "+a5,2000,{session:a7,target:a7})}var a4=function(){if(!a6.isDefaultPrevented()){try{a7.cleanup()}catch(ba){b.handleJsException("TB.sessionDisconnected :: "+ba,2000,{session:a7,target:a7})}}};setTimeout(a4,2)},streamCreatedHandler:function(a8,a4,a7){u("TB.streamCreated");var a6=this.sessions[a8],a9=f(a4,a8);try{a6.dispatchEvent(new aL(this.STREAM_CREATED,a9,a7))}catch(a5){b.handleJsException("TB.streamCreated :: "+a5,2000,{session:a6,target:stream})}},streamDestroyedHandler:function(a8,a6,ba){u("TB.streamDestroyed");var a9,a4,bc=this.sessions[a8],be=f(a6,a8),a5=new aL(this.STREAM_DESTROYED,be,ba,true);for(a9=0;a9<be.length;a9++){var bd=be[a9];delete bc.streams[bd.streamId]}try{bc.dispatchEvent(a5);for(a9=0;a9<a5.streams.length;a9++){a4=bc.getPublisherForStream(a5.streams[a9]);if(a4){a4.session=null}}}catch(a7){b.handleJsException("TB.streamDestroyed :: "+a7,2000,{session:bc,target:bc})}var bb=function(){for(a9=0;a9<a5.streams.length;a9++){if(!a5.isDefaultPrevented()){var bh=bc.getSubscribersForStream(a5.streams[a9]);for(var bf=0;bf<bh.length;bf++){try{bc.unsubscribe(bh[bf])}catch(bg){b.handleJsException("TB.streamDestroyed :: "+bg,2000,{session:bc,target:bh[bf]})}}}a4=bc.getPublisherForStream(a5.streams[a9]);if(a4){if(!a5.isDefaultPrevented()){try{a4.destroy()}catch(bg){b.handleJsException("TB.streamDestroyed :: "+bg,2000,{session:bc,target:a4})}}delete bc.publishers[a4.id]}}};setTimeout(bb,2)},streamPropertyChangedHandler:function(ba,a8,a6,a4,a7){u("TB.streamPropertyChangedHandler");var bc=this.sessions[ba];var bd=E(a8,ba);bd[a6]=a7;var a5=new Y(this.STREAM_PROPERTY_CHANGED,bd,a6,a4,a7);bc.dispatchEvent(a5);try{var be,bb;if("hasAudio"==a6){for(bb in bc.subscribers){be=bc.subscribers[bb];if(be.hasOwnProperty("stream")&&be.stream.streamId==bd.streamId){be._subscribeToAudio(a7,true);break}}}else{if("hasVideo"==a6){for(bb in bc.subscribers){be=bc.subscribers[bb];if(be.hasOwnProperty("stream")&&be.stream.streamId==bd.streamId){be._subscribeToVideo(a7,true);break}}}else{if("orientation"==a6){for(bb in bc.subscribers){be=bc.subscribers[bb];if(be.hasOwnProperty("stream")&&be.stream.streamId==bd.streamId){be.changeOrientation(a7);break}}}else{if("quality"==a6){}else{u("Unknown property changed")}}}}}catch(a9){b.handleJsException("TB.streamPropertyChangedHandler :: "+a9,2000,{session:bc})}},microphoneLevelChangedHandler:function(a7,bb,a4,a8){var ba=this.sessions[a7],a9;if(!ba){b.handleJsException("TB.microphoneLevelChangedHandler :: Invalid session ID: "+a7,2000);return}try{var bc=ba.subscribers[bb];var a5=new an(this.MICROPHONE_LEVEL_CHANGED,a4,a8);ba.dispatchEvent(a5)}catch(a6){b.handleJsException("microphoneLevelChanged :: "+a6,2000,{session:ba})}},connectionCreatedHandler:function(a9,a4,a8){u("TB.connectionCreated");var a7=this.sessions[a9],a5=ay(a4);try{a7.dispatchEvent(new aJ(this.CONNECTION_CREATED,a5,a8))}catch(a6){b.handleJsException("TB.connectionCreated :: "+a6,2000,{session:a7})}},connectionDestroyedHandler:function(a9,a4,a8){u("TB.connectionDestroyed");var a7=this.sessions[a9],a5=ay(a4);try{a7.dispatchEvent(new aJ(this.CONNECTION_DESTROYED,a5,a8))}catch(a6){b.handleJsException("TB.connectionDestroyed :: "+a6,2000,{session:a7})}},signalHandler:function(a7,a4){u("TB.signal");var a6=this.sessions[a7];try{a6.dispatchEvent(new aQ(this.SIGNAL_RECEIVED,d(a4)))}catch(a5){b.handleJsException("TB.signal ::"+a5,2000,{session:a6})}},archiveCreatedHandler:function(a7,a4){u("TB.archiveCreatedHandler:"+a7+" - "+a4);var a6=this.sessions[a7],a8=s(a4,a7);try{a6.dispatchEvent(new aI(this.ARCHIVE_CREATED,[a8]))}catch(a5){b.handleJsException("TB.archiveCreatedHandler :: "+a5,2000,{session:a6})}},archiveClosedHandler:function(a8,a4){u("TB.archiveClosedHandler:"+a8+" - "+a4.id);try{var a7=this.sessions[a8];var a5=s(a4,a8);a7.dispatchEvent(new aI(this.ARCHIVE_CLOSED,[a5]));delete H[a8][a4.id]}catch(a6){b.handleJsException("TB.archiveClosedHandler :: "+a6,2000,{session:a7})}},archiveLoadedHandler:function(a7,a4){u("TB.archiveLoadedHandler:"+a7+" - "+a4.archiveId);var a6=this.sessions[a7];try{var a8=new C(a4.id,a4.type,a4.title,a7);if(!ao.hasOwnProperty(a7)){ao[a7]={}}ao[a7][a4.id]=a8;a6.dispatchEvent(new aI(this.ARCHIVE_LOADED,[a8]))}catch(a5){b.handleJsException("TB.archiveLoadedHandler :: "+a5,2000,{session:a6})}},sessionRecordingStartedHandler:function(a8,a4){u("TB.sessionRecordingStartedHandler:"+a8+" - "+a4.id);try{var a7=this.sessions[a8];var a5=s(a4,a8);a7.dispatchEvent(new aI(this.SESSION_RECORDING_STARTED,[a5]))}catch(a6){b.handleJsException("TB.sessionRecordingStartedHandler :: "+a6,2000,{session:a7})}},sessionRecordingStoppedHandler:function(ba,a4){u("TB.sessionRecordingStoppedHandler:"+ba+" - "+a4);try{var a9=this.sessions[ba];var a5=s(a4,ba);a9.dispatchEvent(new aI(this.SESSION_RECORDING_STOPPED,[a5]));for(var a8 in a9.publishers){if(a9.publishers[a8].hasOwnProperty("id")){var a7=document.getElementById(a9.publishers[a8].id);if(a7.signalRecordingStopped){a7.signalRecordingStopped()}}}}catch(a6){b.handleJsException("TB.sessionRecordingStoppedHandler :: "+a6,2000,{session:a9})}},sessionRecordingInProgressHandler:function(a6){u("TB.sessionRecordingInProgressHandler");var a5=this.sessions[a6];try{a5.dispatchEvent(new W(this.SESSION_RECORDING_IN_PROGRESS,false))}catch(a4){b.handleJsException("TB.sessionRecordingStartedHandler :: "+a4,2000,{session:a5})}},sessionNotRecordingHandler:function(a6){u("TB.sessionNotRecordingHandler");var a5=this.sessions[a6];try{a5.dispatchEvent(new W(this.SESSION_NOT_RECORDING,false))}catch(a4){b.handleJsException("TB.sessionNotRecordingHandler :: "+a4,2000,{session:a5})}},streamRecordingStartedHandler:function(ba,a5){u("TB.streamRecordingStartedHandler:"+ba);var a8=this.sessions[ba],bb=f(a5,ba);try{a8.dispatchEvent(new aL(this.STREAM_RECORDING_STARTED,bb,"",false));for(var a4=0;a4<a5.length;a4++){var a9=a5[a4];var a7=a8.getPublisherForStream(a9);if(a7){a7._.signalRecording(true);u("TB.streamRecordingStartedHandler: signal: "+a9.streamId)}}}catch(a6){b.handleJsException("TB.streamRecordingStartedHandler :: "+a6,2000,{session:a8})}},streamRecordingStoppedHandler:function(ba,a5){u("TB.streamRecordingStoppedHandler");var a8=this.sessions[ba],bb=f(a5,ba);try{a8.dispatchEvent(new aL(this.STREAM_RECORDING_STOPPED,bb,"",false));for(var a4=0;a4<a5.length;a4++){var a9=a5[a4];var a7=a8.getPublisherForStream(a9);if(a7){a7._.signalRecording(false);u("TB.streamRecordingStoppedHandler: signal: "+a9.streamId)}}}catch(a6){b.handleJsException("TB.streamRecordingStoppedHandler :: "+a6,2000,{session:a8})}},streamRecordingInProgressHandler:function(a7,a4){u("TB.streamRecordingInProgressHandler");var a6=this.sessions[a7],a8=f(a4,a7);try{a6.dispatchEvent(new aL(this.STREAM_RECORDING_IN_PROGRESS,a8,"",false))}catch(a5){b.handleJsException("TB.streamRecordingInProgressHandler :: "+a5,2000,{session:a6})}},streamNotRecordingHandler:function(a7,a4){u("TB.streamNotRecordingHandler");var a6=this.sessions[a7];try{a6.dispatchEvent(new aL(this.STREAM_NOT_RECORDING,a4,"",false))}catch(a5){b.handleJsException("TB.streamNotRecordingHandler :: "+a5,2000,{session:a6})}},playbackStartedHandler:function(a8,a5){u("TB.playbackStartedHandler");var a7=this.sessions[a8],a4=new C(a5.id,a5.type,a5.title,a8);try{a7.dispatchEvent(new aI(this.PLAYBACK_STARTED,[a4]))}catch(a6){b.handleJsException("TB.playbackStartedHandler :: "+a6,2000,{session:a7})}},playbackStoppedHandler:function(a8,a5){u("TB.playbackStoppedHandler");var a7=this.sessions[a8],a4=new C(a5.id,a5.type,a5.title,a8);try{a7.dispatchEvent(new aI(this.PLAYBACK_STOPPED,[a4]))}catch(a6){b.handleJsException("TB.playbackStoppedHandler :: "+a6,2000,{session:a7})}},videoComponentLoadedHandler:function(a6,a8){try{if(a8 in ap){if("_" in ap[a8]&&"onload" in ap[a8]._){var a4=ap[a8];a4._.onload.call(a4)}}else{if(a6){var a7=this.sessions[a6];if(!a7){return}var bc=a7.subscribers[a8];if(bc&&!bc.loaded){bc._.DOMcomponent=document.getElementById(bc.id);bc.loaded=true;if(bc.modified){if(bc.audioSubscribed!=null){bc.subscribeToAudio(bc.audioSubscribed)}if(bc.videoSubscribed!=null){bc.subscribeToVideo(bc.videoSubscribed)}bc.setAudioVolume(bc.audioVolume);bc.setStyle(bc._style);bc.modified=false}bc.dispatchEvent(new W("loaded"))}}else{var ba=B.players[a8];if(ba&&ba.id){ba._.DOMcomponent=document.getElementById(a8)}if(ba&&ba._archiveId){ba.loadArchive(ba._archiveId);ba._archiveId=null}if(ba&&ba._play){ba.play();ba._play=false}var bb=B.recorders[a8];var a9=ba?ba:bb;if(a9&&!a9.loaded){a9.loaded=true;a9._.DOMcomponent=document.getElementById(a9.id);if(a9.modified){a9.setStyle(a9._style);if(a9==bb&&a9._title){a9.setTitle(_title);_title=""}a9.modified=false}a9.dispatchEvent(new W("loaded"))}}}}catch(a5){b.handleJsException("videoComponentLoaded:: initialize component "+a8+" - "+a5,2000,{session:a7})}},videoWidgetStyleHeightFrom:null,videoWidgetStyleWidthFrom:null,resizeVideoComponentToTarget:function(ba,bd){u("TB.resize");try{var a4=(bd in ap)?ap[bd]:B.recorders[bd];var bc=this.sessions[ba];if(!a4){b.handleJsException("TB.resize :: Invalid ID: "+bd,2000,{session:bc});return}var a5=document.getElementById(bd);if(!a5){b.handleJsException("TB.resize :: "+widgetType+" "+bd+" does not exist in the DOM",2000,{session:bc});return}var bb=a5.width;var a9=a5.height;if(a5.width!=a4.properties.width){a5.width=a4.properties.width}if(a5.height!=a4.properties.height){a5.height=a4.properties.height}if(a5.style.height!=videoWidgetStyleHeightFrom){a5.style.height=videoWidgetStyleHeightFrom}if(a5.style.width!=videoWidgetStyleWidthFrom){a5.style.width=videoWidgetStyleWidthFrom}var a7=a5.width;var a8=a5.height;if(bb!=a7||a9!=a8){a4.dispatchEvent(new o(this.RESIZE,bb,a7,a9,a8))}}catch(a6){b.handleJsException("resizeVideoComponentToTarget :: Error resizing "+widgetType+" - "+a6,2000,{session:bc})}},resizeVideoComponentToShowSecurity:function(bb,be,bf){u("TB.resize");var bd=this.sessions[bb];var a5=(be in ap)?ap[be]:B.recorders[be];if(!a5){b.handleJsException("TB.resize :: Invalid "+widgetType+" ID: "+be,2000,{session:bd});return}var a6=document.getElementById(be);if(!a6){b.handleJsException("TB.resize :: "+widgetType+" "+be+" does not exist in the DOM",2000,{session:bd});return}var bc=a5.properties.width=a6.width;var ba=a5.properties.height=a6.height;videoWidgetStyleHeightFrom=a6.style.height;videoWidgetStyleWidthFrom=a6.style.width;var a4=ax*bf;var bg=j*bf;if(a6.width<a4){a6.width=a4;a6.style.width=a4+"px"}if(a6.height<bg){a6.height=bg;a6.style.height=bg+"px"}var a8=a6.width;var a9=a6.height;var a7=a6.style;if(bc!=a8||ba!=a9||videoWidgetStyleWidthFrom!=a7.width||videoWidgetStyleHeightFrom!=a7.height){a5.dispatchEvent(new o(this.RESIZE,bc,a8,ba,a9))}},settingsButtonClickHandler:function(ba,a4){u("TB.settingsButtonClick");var a9=this.sessions[ba];var a8=(a4 in ap)?ap[a4]:false;if(!a8){b.handleJsException("TB.settingsButtonClick :: Invalid publisher ID: "+publisherId,2000,{session:a9});return}try{var a7=new W(this.SETTINGS_BUTTON_CLICK,true);a8.dispatchEvent(a7);var a5=function(){if(!a7.isDefaultPrevented()){var bb=b.initDeviceManager(a9?a9.apiKey:a8.properties.apiKey);bb.displayPanel(null,a8,{})}};setTimeout(a5,2)}catch(a6){b.handleJsException("settingsButtonClick :: "+a6,2000,{session:a9})}},recorderSettingsButtonClickHandler:function(a8){u("TB.recorderSettingsButtonClick");try{var a4=B.recorders[a8];if(!a4){errorMsg="TB.recorderSettingsButtonClick :: Invalid recorder ID: "+a8;aG(errorMsg);b.exceptionHandler(errorMsg,"Internal Error",2000);return}var a7=new W(this.SETTINGS_BUTTON_CLICK,true);a4.dispatchEvent(a7);var a5=function(){if(!a7.isDefaultPrevented()){var a9=b.initDeviceManager(B.apiKey);a9.displayPanel(null,a4,{})}};setTimeout(a5,2)}catch(a6){b.handleJsException("recorderSettingsButtonClick :: "+a6,2000)}},deviceAccessHandler:function(a8,bc,bb){var ba=this.sessions[a8];u("TB.deviceAccessHandler: "+bb);var a6=(bc in ap)?ap[bc]:B.recorders[bc],a4=(bc in ap);if(!a6){b.handleJsException("TB.deviceAccessHandler :: Invalid "+widgetType+" ID: "+bc,2000,{session:ba});return}try{var a5=new W(bb,true);a6.dispatchEvent(a5);if(a4&&(bb==b.ACCESS_DENIED)){var a9=function(){if(a6&&a6.hasOwnProperty("_")&&a6._.hasOwnProperty("refresh")){a6._.refresh()}};setTimeout(a9,2)}}catch(a7){b.handleJsException(bb+" :: "+a7,2000,{session:ba})}},deviceInactiveHandler:function(ba,a4,a5,a7){u("TB.deviceInactiveHandler");try{var a8=this.sessions[ba];if(a4&&a4 in ap){var a9=ap[a4];if("dispatchEvent" in a9){a9.dispatchEvent(new g(this.DEVICE_INACTIVE,a5,a7))}else{b.handleJsException("TB.deviceInactiveHandler :: Invalid component ID: "+a4,2000,{session:a8})}return}}catch(a6){b.handleJsException("deviceInactive :: "+a6,2000,{session:a8})}},invalidDeviceNameHandler:function(a9,bb,a8,a6){u("TB.invalidDeviceNameHandler");var bc=this.sessions[a9];if(!bc){b.handleJsException("TB.deviceInactiveHandler :: Invalid session ID: "+a9,2000);return}try{var a5=bc.publishers[bb];if(!a5){aG("TB.deviceInactiveHandler :: Invalid publisher ID: "+bb);return}switch(a6){case"camera":var ba=new aX(a8,"invalid");var bd=null;break;case"microphone":bd=new aT(a8,"invalid");ba=null;break}var a4=new g(this.INVALID_DEVICE_NAME,ba,bd);a5.dispatchEvent(a4)}catch(a7){b.handleJsException("deviceInactive :: "+a7,2000,{session:bc})}},echoCancellationModeChangedHandler:function(a4,a5,a7){u("TB.echoCancellationModeChangedHandler");try{if(a4&&a4 in ap){var a8=ap[a4];if("dispatchEvent" in a8){a8.dispatchEvent(new g(this.ECHO_CANCELLATION_MODE_CHANGED,a5,a7))}return}}catch(a6){b.handleJsException("TB.echoCancellationModeChangedHandler :: Internal Error",2000)}},microphoneActivityLevelHandler:function(a6,a4){u("TB.microphoneActivityLevelHandler:"+a6);if(a4&&a4 in ap){var a5=ap[a4];if("dispatchEvent" in a5){a5.dispatchEvent(new aC(this.MICLEVEL,a6))}return}},micGainChangedHandler:function(a4,a5){u("TB.micGainChangedHandler:"+a4);if(a5 in ap){ap[a5].dispatchEvent(new aC(this.MICGAINCHANGED,a4))}},devicesDetectedHandler:function(a4,ba,a9,bb,a5){u("TB.devicesDetected");try{var bc=J(a4);var a7=I(ba);if(a5&&a5 in ap){var a6=ap[a5];if("dispatchEvent" in a6){a6.dispatchEvent(new am(this.DEVICES_DETECTED,bc,a7,bc[a9],a7[bb]))}return}else{v.dispatchEvent(new am(this.DEVICES_DETECTED,bc,a7,bc[a9],a7[bb]));setTimeout(function(){aF(a3,"devicesDetectedHandler :: ");a3=null},0)}}catch(a8){b.handleJsException("devicesDetectedHandler :: "+a8,2000)}},devicesSelectedHandler:function(a4,a5,a7){u("TB.devicesSelected");try{aW=true;var a8=v.panels[a4];if(!a8){aG("TB.devicesSelected :: Invalid DevicePanel ID: "+a4);return}if(a8.component){a8.component.setCamera(a5);a8.component.setMicrophone(a7)}a8.dispatchEvent(new g(this.DEVICES_SELECTED,a5,a7))}catch(a6){b.handleJsException("devicesSelected :: "+a6,2000)}},closeButtonClickHandler:function(a4){u("TB.closeButtonClick");try{var a8=v.panels[a4];if(!a8){b.handleJsException("TB.devicesSelected :: Invalid DevicePanel ID: "+a4,2000);return}var a7=new W(this.CLOSE_BUTTON_CLICK,true);a8.dispatchEvent(a7);var a5=function(){if(!a7.isDefaultPrevented()){v.removePanel(a8)}};setTimeout(a5,2)}catch(a6){b.handleJsException("closeButtonClick :: "+a6,2000)}},playerArchiveLoadedHandler:function(a4){u("Player.archiveLoadedHandler");try{var a5=B.players[a4];a5.dispatchEvent(new W(this.ARCHIVE_LOADED))}catch(a6){b.handleJsException("Player.archiveLoadedHandler :: "+a6,2000)}},playingStartedHandler:function(a4){u("Player.playingHandler");try{var a5=B.players[a4];a5.dispatchEvent(new W(this.PLAYBACK_STARTED))}catch(a6){b.handleJsException("Player.playingStartedHandler :: "+a6,2000)}},playingPausedHandler:function(a4){u("Player.playingPausedHandler");try{var a5=B.players[a4];a5.dispatchEvent(new W(this.PLAYBACK_PAUSED))}catch(a6){b.handleJsException("Player.playingPausedHandler :: "+a6,2000)}},playingStoppedHandler:function(a4,a6){u("Player.playingStoppedHandler");try{var a5=B.players[a4];a5.dispatchEvent(new W(this.PLAYBACK_STOPPED))}catch(a7){b.handleJsException("Player.playingStoppedHandler :: "+a7,2000)}},recordingStartedHandler:function(a6){u("Recorder.recordingStartedHandler");try{var a4=B.recorders[a6];a4.dispatchEvent(new W(this.RECORDING_STARTED))}catch(a5){b.handleJsException("Recorder.recordingStartedHandler :: "+a5,2000)}},recordingStoppedHandler:function(a6){u("Recorder.recordingStoppedHandler");try{var a4=B.recorders[a6];a4.dispatchEvent(new W(this.RECORDING_STOPPED))}catch(a5){b.handleJsException("Recorder.recordingStoppedHandler :: "+a5,2000)}},recorderPlaybackStartedHandler:function(a6){u("Recorder.playbackStartedddHandler");try{var a4=B.recorders[a6];a4.dispatchEvent(new W(this.PLAYBACK_STARTED))}catch(a5){b.handleJsException("Recorder.playbackStartedHandler :: "+a5,2000)}},recorderPlaybackStoppedHandler:function(a6){u("Recorder.playbackStoppedHandler");try{var a4=B.recorders[a6];a4.dispatchEvent(new W(this.PLAYBACK_STOPPED))}catch(a5){b.handleJsException("Recorder.playbackStoppedHandler :: "+a5,2000)}},archiveSavedHandler:function(a7,a5){u("Recorder.archiveSavedHandler");try{var a4=B.recorders[a7];var a8=new C(a5.id,a5.type,a5.title);a4.dispatchEvent(new aI(this.ARCHIVE_SAVED,[a8]))}catch(a6){b.handleJsException("Recorder.archiveSavedHandler :: "+a6,2000)}},stateChangedHandler:function(a9,a6){u("TB.stateChangeHandler");var a8=this.sessions[a9];var a5;if(!a8){b.handleJsException("TB.stateChangedHandler :: Invalid session ID: "+a9,2000);return}function a4(bg){var bd={};for(var bf in bg){keyValue=bg[bf];bf=bf.replace(/"/g,"");var bc=bf.match(/TB_archive_([^_]+)_(.*)/);if(bc){archiveId=bc[1];bf=bc[2];var be=ao[a9][archiveId];if(!be){b.handleJsException("Archive.startPlayback :: Archive not loaded.",2000);return}bd[bf]=keyValue;a5=be.getStateManager()}}if(a5){a6=bd}else{a5=a8.getStateManager()}}var bb=false;a4(a6);for(var a7 in a6){if(!bb){a5.dispatchEvent(new al("changed",a6));bb=true}var ba={};ba[a7]=a6[a7];a5.dispatchEvent(new al("changed:"+a7,ba))}if(!bb){a8.getStateManager().dispatchEvent(new al("changed",a6))}},stateChangedFailedHandler:function(a9,a8,a6,a7){u("TB.stateChangedFailedHandler reasonCode:"+a8+" reason:"+a6);var a5=this.sessions[a9];if(!a5){b.handleJsException("TB.stateChangedFailedHandler :: Invalid session ID: "+a9,2000);return}var a4=a5.getStateManager();a4.dispatchEvent(new ar("changeFailed",a8,a6,a7))},reportIssueHandler:function(bn,be,bl,bb){u("TB.reportIssueHandler");if(be==null){be=false}if(L){return}var a6=document.createElement("form");a6.setAttribute("action","http://www.tokbox.com/reportIssue.php");a6.setAttribute("method","post");a6.setAttribute("target","formresult");a0(a6,"issueId",bn);a0(a6,"userAgent",navigator.userAgent);a0(a6,"environment","JS");var bc=swfobject.getFlashPlayerVersion();a0(a6,"flashVersion",bc.major+"."+bc.minor+"."+bc.release);var a8=aU.opentokdebug.getLogs();a0(a6,"jsLogs",a8);var a4=false;var a9={};a9.length=0;for(var bm in b.sessions){var a5=b.sessions[bm];if(!a5.hasOwnProperty("sessionId")){continue}if(!a4){a0(a6,"apiKey",a5.apiKey);a4=true}a0(a6,"session_"+ ++a9.length,a5.sessionId);a9[a5.sessionId]=0;var bi="controller_"+a5.sessionId;var br=az(bi);if(br){a0(a6,"widget_"+a5.sessionId+"_"+ ++a9[a5.sessionId],br)}if(a5.hasOwnProperty("subscribers")){for(var bh in a5.subscribers){if(a5.subscribers[bh].hasOwnProperty("id")){var bo=az(a5.subscribers[bh].id);a0(a6,"widget_"+a5.sessionId+"_"+ ++a9[a5.sessionId],bo)}}}}if(ap){a0(a6,"session_"+ ++a9.length,"null");a9["null"]=0;for(var bd in ap){var bp=ap[bd],ba=null,bk="null";if(bp.hasOwnProperty("id")){ba=az(bp.id);if(bp.session&&"sessionId" in bp.session){bk=bp.session.sessionId}a0(a6,"widget_"+bk+"_"+ ++a9[bk],ba)}}}if(!be){if(!bl&&!bb){var bg=document.createElement("textarea");bg.setAttribute("name","description");bg.setAttribute("rows",8);bg.setAttribute("cols",40);bg.style.height="110px";bg.style.width="300px";bg.style.display="block";bg.style.visibility="visible";a6.appendChild(bg);var bq=document.createElement("input");bq.setAttribute("type","submit");bq.setAttribute("value","Report Issue");bq.style.display="inline";bq.style.visibility="visible";a6.appendChild(bq);var bj=document.createElement("input");bj.setAttribute("type","button");bj.setAttribute("value","Cancel");bj.style.display="inline";bj.style.visibility="visible";a6.appendChild(bj);var bf=x({id:"opentokReportIssue",width:390,height:242,innerHTML:'<span style="color:#4c4c4c;font-size:18px;display:inline;visibility:visible;">We\'re sorry to hear that something went wrong.</span><br/><br/>Please help us to debug your issue by providing a description of what happened.'});bf.appendChild(a6);document.body.appendChild(bf);L=true;closeForm=function(){document.body.removeChild(bf);L=false};bj.onclick=closeForm;a6.onsubmit=function(){aU.open("#","formresult","scrollbars=no,menubar=no,height=200,width=400,resizable=yes,toolbar=no,status=no");setTimeout(function(){closeForm()},1000)}}else{a0(a6,"description",bl);document.body.appendChild(a6);onHiddenPostSubmit=function(){if(bb){b.dispatchEvent(new ai(b.ISSUE_REPORTED,bn));clearTimeout(a7)}};var a7=setTimeout("hiddenPostTimeoutHandler()",7000);hiddenPostTimeoutHandler=function(){if(bb){b.dispatchEvent(new K(b.EXCEPTION,"The call to TB.reportIssue() did not succeed in sending the issue to the server.","Report Issue Failure",2010))}};Z("formresult",a6,{removeFormOnComplete:true,onSubmit:onHiddenPostSubmit})}}if(be){a6.onsubmit=function(){aU.open("#","formresult","scrollbars=no,menubar=no,height=200,width=400,resizable=yes,toolbar=no,status=no");setTimeout(function(){closeForm()},1000)};a0(a6,"showReport",true);document.body.appendChild(a6);a6.submit()}}};aU.TB=b;aZ=new aE();b.onLoad=function(){aZ.onLoad.apply(aZ,arguments)}})(window);(function(d){if(!TB_ChromeAllowFix.allowDenyBugPresent){return}var e=d.initPublisher;d.initPublisher=function(){var i=e.apply(this,arguments),j;i.addEventListener("accessDialogOpened",function(){j=new TB_ChromeAllowFix.AllowFixer(document.getElementById(i.id));j.start()});i.addEventListener("accessDialogClosed",function(){j.stop()});return i};var g=d.initDeviceManager;d.initDeviceManager=function(){var j=g.apply(this,arguments),l={};var i=j.displayPanel;j.displayPanel=function(){var m=i.apply(this,arguments);var o=new TB_ChromeAllowFix.AllowFixer(document.getElementById(m.id));o.start();l[m]=o;return m};var k=j.removePanel;j.removePanel=function(m){if(l[m]){l[m].stop()}return k.apply(this,arguments)};return j};var b=d.initRecorderManager;d.initRecorderManager=function(){var j=b.apply(this,arguments);var i=j.displayRecorder;j.displayRecorder=function(){var l=i.apply(this,arguments),m;l.addEventListener("loaded",function(){m=new TB_ChromeAllowFix.AllowFixer(document.getElementById(l.id));m.start()});var k=function(){m.stop()};l.addEventListener("accessAllowed",k);l.addEventListener("accessDenied",k);return l};return j};var c=d.resizeVideoComponentToShowSecurity;d.resizeVideoComponentToShowSecurity=function(k,i,j){if(j!=1){d.$.tbAlert({innerHTML:"<h2>Warning!</h2><p>You may not be able to click the allow button to allow access to your camera because your browser is zoomed in. Please restore your browser to the normal zoom level by clicking on the 'View' drop down menu and then clicking 'Actual Size'.</p>",height:160})}return c.apply(this,arguments)};var f=h(document);if(f){var a=new TB_ChromeAllowFix.AllowFixer(f);a.start()}function h(j){var k=j.defaultView||j.parentWindow;try{var q=k.parent.document.getElementsByTagName("iframe");for(var l=q.length;l-->0;){var p=q[l];var o=p.contentDocument||p.contentWindow.document;if(o===j){return p}}}catch(m){opentokdebug.error("[ERROR] opentok: Unable to access the parent iframe to adjust for Chrome Allow/Deny issue. You may not be able to click the allow button.")}return null}})(TB);